<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <title>PANfm</title>
    <!-- Google Fonts: Roboto and Open Sans -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <style>
        :root {
            --font-primary: 'Roboto', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            --font-secondary: 'Open Sans', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-secondary);
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
        }

        /* Typography - Use Roboto for headings, Open Sans for body */
        h1, h2, h3, h4, h5, h6,
        .header h1,
        .stat-label,
        .menu-item,
        button {
            font-family: var(--font-primary);
        }

        .sidebar {
            width: 250px;
            min-width: 200px;
            max-width: 400px;
            background: linear-gradient(180deg, #2d2d2d 0%, #1a1a1a 100%);
            border-right: 3px solid #FA582D;
            display: flex;
            flex-direction: column;
            position: relative;
            transition: width 0.3s ease, border-right-color 0.5s ease, margin-left 0.3s ease;
            overflow: hidden;
        }

        /* Collapsed sidebar state */
        .sidebar.collapsed {
            width: 0;
            min-width: 0;
            border-right-width: 0;
            margin-left: -250px;
        }

        /* Auto-hide separator after inactivity */
        .sidebar.separator-hidden {
            border-right-color: transparent;
        }

        /* Show separator on hover */
        .sidebar:hover {
            border-right-color: #FA582D !important;
        }

        /* Sidebar toggle button */
        .sidebar-toggle {
            position: fixed;
            left: 260px;
            top: 20px;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #FA582D 0%, #C64620 100%);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: left 0.3s ease, transform 0.2s ease;
        }

        .sidebar-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(250, 88, 45, 0.5);
        }

        .sidebar.collapsed + .sidebar-toggle {
            left: 10px;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 2px solid rgba(255, 102, 0, 0.3);
            background: #2d2d2d;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px 8px 0 0;
        }

        .sidebar-logo {
            width: auto;
            max-width: 100%;
            height: auto;
            display: block;
        }

        .sidebar-subtitle {
            color: #999;
            font-size: 0.8em;
        }

        .sidebar-menu {
            padding: 15px 0;
        }

        .menu-item {
            padding: 10px 20px;
            color: #cccccc;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.25s ease;
            border-left: 4px solid transparent;
            font-size: 0.82em;
            font-family: var(--font-primary);
            letter-spacing: 0.3px;
            background: linear-gradient(90deg, rgba(255,180,150,0.03) 0%, rgba(255,180,150,0.08) 100%);
            margin: 2px 0;
        }

        .menu-item:hover {
            background: linear-gradient(90deg, rgba(255,180,150,0.12) 0%, rgba(255,180,150,0.18) 100%);
            border-left-color: #FA582D;
            color: #F2F0EF;
            box-shadow: inset 4px 0 0 #FA582D, 0 2px 4px rgba(0,0,0,0.1);
        }

        .menu-item.active {
            background: linear-gradient(90deg, rgba(250,88,45,0.2) 0%, rgba(250,88,45,0.3) 100%);
            border-left-color: #FA582D;
            color: #F2F0EF;
            font-weight: 600;
            box-shadow: inset 4px 0 0 #FA582D, 0 2px 6px rgba(250,88,45,0.2);
        }

        .menu-icon {
            font-size: 0.7em;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FA582D 0%, #F2A65A 100%);
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            display: inline-block;
        }

        .menu-item.active .menu-icon {
            background: linear-gradient(135deg, #F2F0EF 0%, #FA582D 100%);
            box-shadow: 0 2px 4px rgba(250,88,45,0.4);
        }

        .resize-handle {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 5px;
            cursor: ew-resize;
            background: transparent;
            transition: background 0.2s ease;
        }

        .resize-handle:hover {
            background: rgba(255, 102, 0, 0.5);
        }

        .main-content {
            flex-grow: 1;
            overflow-y: auto;
            padding: 15px;
            width: calc(100vw - 250px);
            transition: width 0.3s ease, margin-left 0.3s ease;
        }

        /* Expand main content when sidebar is collapsed */
        .sidebar.collapsed ~ .main-content {
            width: 100vw;
            margin-left: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: left;
            color: #F2F0EF;
            margin-bottom: 15px;
            animation: fadeIn 0.5s ease-in;
        }

        .header h1 {
            font-family: var(--font-primary);
            font-size: 1.5em;
            font-weight: 700;
            margin: 0;
        }

        .header p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #ffffff 0%, #f5f5f5 100%);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: slideUp 0.5s ease-out;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 120px;
            max-height: 120px;
            border-left: 4px solid #FA582D;
        }

        .stat-card.threat-card {
            padding: 15px;
        }

        .stat-card.threat-card .stat-label {
            font-size: 0.85em;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .stat-card.threat-card .stat-value {
            font-size: 1.6em;
            margin-bottom: 5px;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 102, 0, 0.4);
            border-left-color: #FF7A55;
        }

        .stat-icon {
            font-size: 1.4em;
            margin-bottom: 5px;
            opacity: 0.7;
        }

        .stat-label {
            font-size: 0.7em;
            color: #333;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
        }

        .stat-value {
            font-size: clamp(1.2em, 3vw, 1.8em);
            font-weight: bold;
            color: #FA582D;
            margin-bottom: 3px;
            word-break: break-word;
            line-height: 1.1;
        }

        .mini-chart {
            border-left: 1px solid #d1d5db;
            border-right: 1px solid #d1d5db;
            border-bottom: 1px solid #d1d5db;
            border-radius: 4px;
            margin-top: 5px;
            margin-bottom: 12px;
            padding: 2px;
            background: rgba(255, 255, 255, 0.5);
        }

        .stat-unit {
            font-size: 0.7em;
            color: #999;
            margin-bottom: 5px;
        }

        .mini-chart {
            margin-top: auto;
            height: 30px;
        }

        .threat-card {
            height: 400px !important;
            max-height: 400px !important;
        }

        .threat-logs-container {
            margin-top: 10px;
            flex-grow: 1;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: 295px;
        }

        .threat-logs-container::-webkit-scrollbar {
            width: 6px;
        }

        .threat-logs-container::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 3px;
        }

        .threat-logs-container::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.4);
            border-radius: 3px;
            transition: background 0.2s ease;
        }

        .threat-logs-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.6);
        }

        .threat-log-table {
            width: 100%;
            font-size: 0.75em;
            border-collapse: collapse;
            border-spacing: 0;
            table-layout: fixed;
        }

        .threat-log-table th {
            text-align: left;
            padding: 10px 12px;
            font-weight: 700;
            color: rgba(255,255,255,0.98);
            text-transform: uppercase;
            font-size: 0.8em;
            letter-spacing: 0.8px;
            border-bottom: 2px solid rgba(255,255,255,0.4);
            background: rgba(0,0,0,0.25);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .threat-log-table th:first-child {
            width: 60%;
        }

        .threat-log-table th:last-child {
            width: 40%;
        }

        .threat-log-table td {
            padding: 10px 12px;
            background: rgba(255,255,255,0.15);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: all 0.2s ease;
            color: rgba(255,255,255,0.95);
        }

        .threat-log-table tr:hover td {
            background: rgba(255,255,255,0.25);
            transform: translateX(3px);
            box-shadow: -3px 0 0 0 rgba(255,255,255,0.5);
        }

        .threat-log-table tr td:first-child {
            font-weight: 600;
            border-left: 3px solid rgba(255,255,255,0.5);
        }

        .threat-log-table tr:hover td:first-child {
            border-left-color: rgba(255,255,255,0.9);
        }

        .threat-name {
            font-weight: 600;
            color: rgba(255,255,255,0.98);
            max-width: 250px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            cursor: help;
            display: block;
        }

        .threat-src {
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            color: rgba(255,255,255,0.9);
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
        }

        .threat-time {
            color: rgba(255,255,255,0.95);
            font-size: 0.95em;
            font-weight: 500;
            font-family: 'Courier New', monospace;
        }

        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            animation: slideUp 0.6s ease-out;
            border-top: 4px solid #F7D9BC;
        }

        .chart-wrapper {
            position: relative;
            height: 350px;
        }

        .status-indicator {
            position: fixed;
            top: 15px;
            right: 15px;
            padding: 6px 12px;
            border-radius: 20px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
            font-size: 0.85em;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.online {
            background: #10b981;
        }

        .status-dot.offline {
            background: #ef4444;
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #fee2e2;
            color: #991b1b;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #F2F0EF;
            font-size: 1.2em;
        }

        .settings-tab:hover {
            background: rgba(250, 88, 45, 0.05) !important;
            color: #FA582D !important;
        }

        .settings-tab.active:hover {
            background: white !important;
            color: #333 !important;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .stat-value {
                font-size: 2em;
            }

            .chart-wrapper {
                height: 300px;
            }
        }

        /* Alert System Styles */
        .templates-grid,
        .quick-start-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .template-card,
        .scenario-card {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .template-card:hover,
        .scenario-card:hover {
            border-color: #FA582D;
            box-shadow: 0 4px 12px rgba(250, 88, 45, 0.2);
            transform: translateY(-2px);
        }

        .template-card h3,
        .scenario-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .template-description,
        .scenario-description {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .template-info,
        .scenario-info {
            margin: 15px 0;
        }

        .template-info .badge,
        .badge {
            display: inline-block;
            padding: 4px 10px;
            background: #e0e0e0;
            color: #333;
            border-radius: 4px;
            font-size: 0.85em;
            margin-right: 8px;
            margin-bottom: 8px;
        }

        .btn-small {
            padding: 8px 16px;
            background: #f0f0f0;
            color: #333;
            border: none;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            margin-right: 8px;
            transition: all 0.2s;
        }

        .btn-small:hover {
            background: #e0e0e0;
        }

        .btn-small.btn-primary {
            background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%);
            color: #F2F0EF;
        }

        .btn-small.btn-primary:hover {
            transform: scale(1.05);
        }

        .btn-primary {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: #F2F0EF;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary:hover {
            transform: scale(1.05);
        }

        .severity-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .severity-critical {
            background: #dc3545;
            color: #F2F0EF;
        }

        .severity-warning {
            background: #ffc107;
            color: #333;
        }

        .severity-info {
            background: #17a2b8;
            color: #F2F0EF;
        }

        .template-alerts-list {
            list-style: none;
            padding: 0;
        }

        .template-alerts-list li {
            padding: 12px;
            background: #f8f9fa;
            border-left: 4px solid #FA582D;
            margin-bottom: 10px;
            border-radius: 4px;
        }

        .template-alerts-list li strong {
            color: #FA582D;
        }

        .template-alerts-list li em {
            display: block;
            margin-top: 5px;
            color: #666;
            font-size: 0.9em;
        }

        .scenario-info p {
            margin: 8px 0;
            color: #666;
            font-size: 0.9em;
        }

        .scenario-info strong {
            color: #333;
        }

        /* Pulsing animation for status dot */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                box-shadow: 0 0 8px rgba(0, 204, 102, 0.6);
            }
            50% {
                opacity: 0.6;
                box-shadow: 0 0 12px rgba(0, 204, 102, 0.9);
            }
        }

        .status-pulse {
            animation: pulse 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <!-- Sidebar Menu -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div style="text-align: center; width: 100%;">
                <div style="font-family: var(--font-primary); font-size: 28px; font-weight: 900; margin: 0;">
                    <span style="color: #FA582D;">PAN</span><span style="color: #000; text-shadow: -1px -1px 0 #FA582D, 1px -1px 0 #FA582D, -1px 1px 0 #FA582D, 1px 1px 0 #FA582D;">fm</span>
                </div>

                <!-- Device Selector with Connection Status -->
                <div style="margin-top: 10px; padding: 0 10px;">
                    <!-- Connection Status Indicator -->
                    <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 10px;">
                        <div id="statusDot" class="status-pulse" style="width: 12px; height: 12px; border-radius: 50%; background: #00cc66;"></div>
                        <span style="color: #F2F0EF; font-size: 0.8em; font-family: var(--font-secondary); font-weight: 500;">Connected</span>
                    </div>

                    <!-- Device Name -->
                    <div id="deviceName" style="text-align: center; color: #F2F0EF; font-size: 0.9em; font-family: var(--font-secondary); font-weight: 600; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                    </div>

                    <!-- Device IP Address -->
                    <div id="deviceIP" style="text-align: center; color: #999; font-size: 0.75em; font-family: var(--font-secondary); margin-bottom: 8px;">
                    </div>

                    <!-- Device Selector Dropdown -->
                    <select id="deviceSelector" style="width: 100%; padding: 6px 8px; border: 2px solid #FA582D; border-radius: 6px; background: white; color: #333; font-size: 0.8em; cursor: pointer; font-family: var(--font-secondary);">
                        <option value="">Loading devices...</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="sidebar-menu">
            <div class="menu-item active" data-page="homepage">
                <span class="menu-icon"></span>
                <span>Dashboard</span>
            </div>
            <div class="menu-item" data-page="connected-devices">
                <span class="menu-icon"></span>
                <span>Connected Devices</span>
            </div>
            <div class="menu-item" data-page="applications">
                <span class="menu-icon"></span>
                <span>Applications</span>
            </div>
            <div class="menu-item" data-page="device-info">
                <span class="menu-icon"></span>
                <span>Device Info</span>
            </div>
            <div class="menu-item" data-page="logs">
                <span class="menu-icon"></span>
                <span>Logs</span>
            </div>
            <div class="menu-item" data-page="alerts">
                <span class="menu-icon"></span>
                <span>Alerts</span>
            </div>
            <div class="menu-item" data-page="analytics">
                <span class="menu-icon"></span>
                <span>Insights</span>
            </div>
            <div class="menu-item" data-page="settings">
                <span class="menu-icon"></span>
                <span>Settings</span>
            </div>
            <div class="menu-item" data-page="devices">
                <span class="menu-icon"></span>
                <span>Managed Devices</span>
            </div>
        </div>

        <!-- System Stats -->
        <div style="padding: 20px 15px; border-top: 1px solid rgba(255, 102, 0, 0.2);">
            <div style="font-size: 0.75em; color: #F2F0EF; font-weight: 600; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px; font-family: var(--font-primary);">System Info</div>
            <div style="margin-bottom: 15px;">
                <div style="color: #999; font-size: 0.7em; font-family: var(--font-secondary);">WAN IP Address</div>
                <div id="sidebarWanIp" style="color: #F2F0EF; font-size: 0.75em; font-weight: 600; font-family: var(--font-primary);">-</div>
                <div id="sidebarWanSpeed" style="color: #999; font-size: 0.65em; margin-top: 2px; font-family: var(--font-secondary);">-</div>
            </div>
            <div style="margin-bottom: 15px;">
                <div style="color: #999; font-size: 0.7em; font-family: var(--font-secondary);">Firewall Uptime</div>
                <div id="sidebarUptime" style="color: #F2F0EF; font-size: 0.75em; font-weight: 600; font-family: var(--font-primary);">-</div>
            </div>
            <div style="margin-bottom: 15px;">
                <div style="color: #999; font-size: 0.7em; font-family: var(--font-secondary);">CPU Temperature</div>
                <div id="sidebarCpuTemp" style="color: #F2F0EF; font-size: 0.75em; font-weight: 600; font-family: var(--font-primary);">-</div>
            </div>
            <div style="margin-bottom: 15px;">
                <div style="color: #999; font-size: 0.7em; font-family: var(--font-secondary);">PAN-OS Version</div>
                <div id="sidebarPanosVersion" style="color: #F2F0EF; font-size: 0.75em; font-weight: 600; font-family: var(--font-primary);">-</div>
            </div>
            <div>
                <div style="color: #999; font-size: 0.7em; font-family: var(--font-secondary);">Licenses</div>
                <div style="color: #F2F0EF; font-size: 0.75em; font-weight: 600; font-family: var(--font-primary);">
                    <span style="color: #999; font-size: 0.93em;">Expired: </span><span id="sidebarLicenseExpired">-</span>
                    <span style="color: #999; margin: 0 4px;">|</span>
                    <span style="color: #999; font-size: 0.93em;">Active: </span><span id="sidebarLicenseLicensed">-</span>
                </div>
            </div>
        </div>

        <div style="flex-grow: 1;"></div>

        <!-- Logout Button -->
        <div style="padding: 10px 15px; border-top: 1px solid rgba(255, 102, 0, 0.2);">
            <button id="logoutBtn"
                    style="width: 100%; padding: 8px 12px; background: transparent; color: #FA582D; border: 1px solid #FA582D; border-radius: 6px; font-family: var(--font-primary); font-size: 0.8em; font-weight: 600; cursor: pointer; transition: all 0.2s;"
                    onmouseover="this.style.background='#FA582D'; this.style.color='white'"
                    onmouseout="this.style.background='transparent'; this.style.color='#FA582D'">
                Logout
            </button>
        </div>

        <div class="resize-handle"></div>
    </div>

    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle" id="sidebarToggle" title="Toggle sidebar">
        <span id="toggleIcon">◀</span>
    </button>

    <!-- Main Content Area -->
    <div class="main-content">

        <!-- Homepage Content -->
        <div id="homepage-content" class="page-content">
            <div class="container">

        <div id="debugAlert" style="display: none; margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); border-left: 5px solid #C44520; border-radius: 8px; color: #F2F0EF; font-weight: 600; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            ⚠️ Debug Logging is Enabled - All API responses are being logged to debug.log
        </div>

        <div class="error-message" id="errorMessage"></div>

        <!-- Throughput Graph -->
        <div style="background: rgba(255, 180, 150, 0.12); border-radius: 12px; padding: 20px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h2 style="color: #F2F0EF; font-size: 1.3em; font-weight: 700; margin: 0; font-family: var(--font-primary);">Network Throughput</h2>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <!-- Time Range Selector -->
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label style="color: #F2F0EF; font-weight: 500; font-size: 0.85em; font-family: var(--font-secondary);">Time Range:</label>
                        <select id="timeRangeSelect" style="padding: 6px 10px; border: 2px solid #FA582D; border-radius: 6px; font-size: 0.85em; background: #fafafa; cursor: pointer; font-family: var(--font-secondary);">
                            <option value="5m">5 Minutes</option>
                            <option value="15m">15 Minutes</option>
                            <option value="30m" selected>30 Minutes</option>
                            <option value="60m">60 Minutes</option>
                        </select>
                    </div>
                    <!-- Interface Selector -->
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label style="color: #F2F0EF; font-weight: 500; font-size: 0.85em; font-family: var(--font-secondary);">Interface:</label>
                        <input type="text" id="monitoredInterfaceInput" placeholder="ethernet1/12" value="ethernet1/12"
                               style="padding: 6px 10px; border: 2px solid #FA582D; border-radius: 6px; font-size: 0.85em; width: 140px; font-family: var(--font-secondary);">
                        <button id="updateInterfaceBtn"
                                style="padding: 6px 14px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">
                            Update
                        </button>
                    </div>
                </div>
            </div>
            <div style="background: #3c3c3c; border-radius: 8px; padding: 15px;">
                <svg id="throughputChart" width="100%" height="240"></svg>
            </div>
            <!-- Custom Legend -->
            <div style="display: flex; justify-content: center; gap: 20px; margin-top: 10px; padding: 4px; font-family: var(--font-secondary);">
                <div style="display: flex; align-items: center; gap: 5px;">
                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #ff6600;"></div>
                    <span style="color: rgba(255, 255, 255, 0.8); font-size: 0.75em;">Inbound</span>
                </div>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #ff9933;"></div>
                    <span style="color: rgba(255, 255, 255, 0.8); font-size: 0.75em;">Outbound</span>
                </div>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #333333;"></div>
                    <span style="color: rgba(255, 255, 255, 0.8); font-size: 0.75em;">Total</span>
                </div>
            </div>
            <!-- Network Traffic Stats -->
            <div style="display: flex; justify-content: center; gap: 30px; margin-top: 6px; padding: 8px; font-family: var(--font-secondary);">
                <div style="text-align: center;">
                    <span style="color: rgba(255, 255, 255, 0.7); font-size: 0.85em;">Total:</span>
                    <span id="totalValue" style="color: #F2F0EF; font-weight: 700; font-size: 0.95em; margin-left: 5px; font-family: var(--font-primary);">-</span>
                    <span style="color: rgba(255, 255, 255, 0.6); font-size: 0.8em; margin-left: 3px;">Mbps</span>
                </div>
                <div style="text-align: center;">
                    <span style="color: rgba(255, 255, 255, 0.7); font-size: 0.85em;">Inbound:</span>
                    <span id="inboundValue" style="color: #F2F0EF; font-weight: 700; font-size: 0.95em; margin-left: 5px; font-family: var(--font-primary);">-</span>
                    <span style="color: rgba(255, 255, 255, 0.6); font-size: 0.8em; margin-left: 3px;">Mbps</span>
                </div>
                <div style="text-align: center;">
                    <span style="color: rgba(255, 255, 255, 0.7); font-size: 0.85em;">Outbound:</span>
                    <span id="outboundValue" style="color: #F2F0EF; font-weight: 700; font-size: 0.95em; margin-left: 5px; font-family: var(--font-primary);">-</span>
                    <span style="color: rgba(255, 255, 255, 0.6); font-size: 0.8em; margin-left: 3px;">Mbps</span>
                </div>
            </div>
            <!-- 5-Minute Averages / Historical Stats -->
            <div id="avgStatsContainer" style="display: flex; justify-content: center; gap: 30px; margin-top: 2px; padding: 6px; font-family: var(--font-secondary); border-top: 1px solid rgba(255, 255, 255, 0.1);">
                <div style="text-align: center;">
                    <span style="color: rgba(255, 255, 255, 0.5); font-size: 0.75em;">Total Avg:</span>
                    <span id="totalAvg" style="color: rgba(255, 255, 255, 0.7); font-weight: 600; font-size: 0.85em; margin-left: 5px; font-family: var(--font-primary);">-</span>
                    <span style="color: rgba(255, 255, 255, 0.4); font-size: 0.7em; margin-left: 3px;">Mbps</span>
                    <span id="totalMinMax" style="color: rgba(255, 255, 255, 0.4); font-size: 0.65em; margin-left: 5px; display: none;"></span>
                </div>
                <div style="text-align: center;">
                    <span style="color: rgba(255, 255, 255, 0.5); font-size: 0.75em;">Inbound Avg:</span>
                    <span id="inboundAvg" style="color: rgba(255, 255, 255, 0.7); font-weight: 600; font-size: 0.85em; margin-left: 5px; font-family: var(--font-primary);">-</span>
                    <span style="color: rgba(255, 255, 255, 0.4); font-size: 0.7em; margin-left: 3px;">Mbps</span>
                    <span id="inboundMinMax" style="color: rgba(255, 255, 255, 0.4); font-size: 0.65em; margin-left: 5px; display: none;"></span>
                </div>
                <div style="text-align: center;">
                    <span style="color: rgba(255, 255, 255, 0.5); font-size: 0.75em;">Outbound Avg:</span>
                    <span id="outboundAvg" style="color: rgba(255, 255, 255, 0.7); font-weight: 600; font-size: 0.85em; margin-left: 5px; font-family: var(--font-primary);">-</span>
                    <span style="color: rgba(255, 255, 255, 0.4); font-size: 0.7em; margin-left: 3px;">Mbps</span>
                    <span id="outboundMinMax" style="color: rgba(255, 255, 255, 0.4); font-size: 0.65em; margin-left: 5px; display: none;"></span>
                </div>
                <div id="sampleCountDisplay" style="text-align: center; display: none;">
                    <span style="color: rgba(255, 255, 255, 0.5); font-size: 0.75em;">Samples:</span>
                    <span id="historicalSampleCount" style="color: rgba(255, 255, 255, 0.7); font-weight: 600; font-size: 0.85em; margin-left: 5px; font-family: var(--font-primary);">-</span>
                </div>
            </div>
        </div>

        <!-- Firewall Health Status Bar (horizontal layout like throughput stats) -->
        <div style="margin-bottom: 20px; padding: 15px; background: rgba(255, 180, 150, 0.12); border-radius: 8px; color: #F2F0EF; border-top: 4px solid #F2F0EF;">
            <div style="display: flex; align-items: center; justify-content: space-around; flex-wrap: wrap; gap: 20px;">

                <!-- CPU -->
                <div style="text-align: center;">
                    <div style="font-size: 0.75em; opacity: 0.8; font-family: var(--font-secondary); margin-bottom: 2px;">Data Plane CPU</div>
                    <div style="font-size: 1.5em; font-weight: 700; font-family: var(--font-primary); color: #FA582D;">
                        <span id="cyberHealthCpu">-</span><span style="font-size: 0.6em;">%</span>
                    </div>
                </div>

                <!-- Memory -->
                <div style="text-align: center;">
                    <div style="font-size: 0.75em; opacity: 0.8; font-family: var(--font-secondary); margin-bottom: 2px;">Memory</div>
                    <div style="font-size: 1.5em; font-weight: 700; font-family: var(--font-primary); color: #FA582D;">
                        <span id="cyberHealthMemory">-</span><span style="font-size: 0.6em;">%</span>
                    </div>
                </div>

                <!-- PPS -->
                <div style="text-align: center;">
                    <div style="font-size: 0.75em; opacity: 0.8; font-family: var(--font-secondary); margin-bottom: 2px;">PPS</div>
                    <div style="font-size: 1.5em; font-weight: 700; font-family: var(--font-primary);" id="cyberHealthPps">-</div>
                </div>

                <!-- Sessions -->
                <div style="text-align: center;">
                    <div style="font-size: 0.75em; opacity: 0.8; font-family: var(--font-secondary); margin-bottom: 2px;">Sessions</div>
                    <div style="font-size: 1.5em; font-weight: 700; font-family: var(--font-primary);" id="cyberHealthSessions">-</div>
                </div>

                <!-- Top Category (Local LAN vs Internet) -->
                <div style="min-width: 300px; padding: 8px 12px; background: rgba(255, 180, 150, 0.12); border-radius: 4px; border-top: 2px solid white;">
                    <!-- Header -->
                    <div style="font-size: 0.75em; color: #F2F0EF; font-family: var(--font-secondary); margin-bottom: 6px; text-align: center; border-bottom: 2px solid white; padding-bottom: 4px;">
                        Top Category (60 min)
                    </div>

                    <!-- Split View Container -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <!-- Left: Local LAN Category -->
                        <div style="border-right: 1px solid rgba(255,255,255,0.3); padding-right: 6px;">
                            <div style="font-size: 0.7em; color: #F2F0EF; font-weight: 600; margin-bottom: 3px; font-family: var(--font-primary);">
                                Local LAN
                            </div>
                            <div id="cyberHealthTopCategoryLAN" style="font-size: 0.85em; color: #F2F0EF; font-weight: 600; margin-bottom: 4px; font-family: var(--font-primary);">-</div>
                            <div style="font-size: 0.65em; color: rgba(255,255,255,0.8); font-family: var(--font-secondary);">
                                <div>↑ <span id="cyberHealthTopCategoryLANSent">--</span></div>
                                <div>↓ <span id="cyberHealthTopCategoryLANReceived">--</span></div>
                            </div>
                        </div>

                        <!-- Right: Internet Category -->
                        <div style="padding-left: 6px;">
                            <div style="font-size: 0.7em; color: #F2F0EF; font-weight: 600; margin-bottom: 3px; font-family: var(--font-primary);">
                                Internet
                            </div>
                            <div id="cyberHealthTopCategoryInternet" style="font-size: 0.85em; color: #F2F0EF; font-weight: 600; margin-bottom: 4px; font-family: var(--font-primary);">-</div>
                            <div style="font-size: 0.65em; color: rgba(255,255,255,0.8); font-family: var(--font-secondary);">
                                <div>↑ <span id="cyberHealthTopCategoryInternetSent">--</span></div>
                                <div>↓ <span id="cyberHealthTopCategoryInternetReceived">--</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Clients (Local LAN vs Internet) -->
                <div style="min-width: 300px; padding: 8px 12px; background: rgba(255, 180, 150, 0.12); border-radius: 4px; border-top: 2px solid white;">
                    <!-- Header -->
                    <div style="font-size: 0.75em; color: #F2F0EF; font-family: var(--font-secondary); margin-bottom: 6px; text-align: center; border-bottom: 2px solid white; padding-bottom: 4px;">
                        Top Clients (60 min)
                    </div>

                    <!-- Split View Container -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <!-- Left: Local LAN Client -->
                        <div style="border-right: 1px solid rgba(255,255,255,0.3); padding-right: 6px;">
                            <div style="font-size: 0.7em; color: #F2F0EF; font-weight: 600; margin-bottom: 3px; font-family: var(--font-primary);">
                                Local LAN
                            </div>
                            <div id="cyberHealthTopInternalIp" style="font-size: 0.85em; color: #F2F0EF; font-weight: 600; margin-bottom: 1px; font-family: var(--font-primary);">--</div>
                            <div id="cyberHealthTopInternalHostname" style="font-size: 0.7em; color: rgba(255,255,255,0.8); margin-bottom: 4px; font-family: var(--font-secondary);">--</div>
                            <div style="font-size: 0.65em; color: rgba(255,255,255,0.8); font-family: var(--font-secondary);">
                                <div>↑ <span id="cyberHealthTopInternalSent">--</span></div>
                                <div>↓ <span id="cyberHealthTopInternalReceived">--</span></div>
                            </div>
                        </div>

                        <!-- Right: Internet Client -->
                        <div style="padding-left: 6px;">
                            <div style="font-size: 0.7em; color: #F2F0EF; font-weight: 600; margin-bottom: 3px; font-family: var(--font-primary);">
                                Internet
                            </div>
                            <div id="cyberHealthTopInternetIp" style="font-size: 0.85em; color: #F2F0EF; font-weight: 600; margin-bottom: 1px; font-family: var(--font-primary);">--</div>
                            <div id="cyberHealthTopInternetHostname" style="font-size: 0.7em; color: rgba(255,255,255,0.8); margin-bottom: 4px; font-family: var(--font-secondary);">--</div>
                            <div style="font-size: 0.65em; color: rgba(255,255,255,0.8); font-family: var(--font-secondary);">
                                <div>↑ <span id="cyberHealthTopInternetSent">--</span></div>
                                <div>↓ <span id="cyberHealthTopInternetReceived">--</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Active Alerts (clickable) -->
                <div style="text-align: center; min-width: 120px; cursor: pointer;" onclick="showPage('alerts')">
                    <div style="font-size: 0.75em; opacity: 0.8; font-family: var(--font-secondary); margin-bottom: 2px;">Active Alerts</div>
                    <div style="font-size: 1.5em; font-weight: 700; font-family: var(--font-primary);" id="cyberHealthActiveAlerts">-</div>
                </div>

            </div>
        </div>

        <!-- Traffic Flow Chord Diagrams -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 20px;">
            <!-- Internal Traffic Flow -->
            <div style="background: rgba(255, 180, 150, 0.12); border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-top: 4px solid #F2F0EF;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #F2F0EF; margin: 0; font-size: 1.2em; font-family: var(--font-primary);">Internal Traffic</h3>
                    <span id="chordInternalCount" style="color: rgba(255, 255, 255, 0.7); font-size: 0.75em; font-family: var(--font-secondary);">Loading...</span>
                </div>
                <div style="position: relative; height: 400px;">
                    <svg id="chordInternalSvg" style="width: 100%; height: 100%;"></svg>
                    <div id="chordInternalLoading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: rgba(255, 255, 255, 0.7); font-family: var(--font-secondary);">Loading internal traffic...</div>
                </div>
            </div>

            <!-- Internet Traffic Flow -->
            <div style="background: rgba(255, 180, 150, 0.12); border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-top: 4px solid #F2F0EF;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #F2F0EF; margin: 0; font-size: 1.2em; font-family: var(--font-primary);">Internet Traffic</h3>
                    <span id="chordInternetCount" style="color: rgba(255, 255, 255, 0.7); font-size: 0.75em; font-family: var(--font-secondary);">Loading...</span>
                </div>
                <div style="position: relative; height: 400px;">
                    <svg id="chordInternetSvg" style="width: 100%; height: 100%;"></svg>
                    <div id="chordInternetLoading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: rgba(255, 255, 255, 0.7); font-family: var(--font-secondary);">Loading internet traffic...</div>
                </div>
            </div>

            <!-- Tag-Filtered Traffic Flow -->
            <div style="background: rgba(255, 180, 150, 0.12); border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-top: 4px solid #F2F0EF;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #F2F0EF; margin: 0; font-size: 1.2em; font-family: var(--font-primary);">Tagged Traffic</h3>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span id="chordTagCount" style="color: rgba(255, 255, 255, 0.7); font-size: 0.75em; font-family: var(--font-secondary);">Select tags</span>
                        <button onclick="openChordTagFilterModal()" style="background: none; border: none; cursor: pointer; color: rgba(255, 255, 255, 0.9); font-size: 1.2em; padding: 5px; line-height: 1; transition: color 0.2s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='rgba(255, 255, 255, 0.9)'" title="Filter by tags">⚙️</button>
                    </div>
                </div>
                <div style="position: relative; height: 400px;">
                    <svg id="chordTagSvg" style="width: 100%; height: 100%;"></svg>
                    <div id="chordTagLoading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: rgba(255, 255, 255, 0.7); font-family: var(--font-secondary);">Click ⚙️ to select tags...</div>
                </div>
                <!-- Selected Tags Display -->
                <div id="chordTagFilters" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255, 255, 255, 0.1); font-family: var(--font-secondary); font-size: 0.85em; color: rgba(255, 255, 255, 0.7);">
                    <span style="font-weight: 600; margin-right: 8px;">Selected Tags:</span>
                    <span id="chordTagFiltersList" style="color: rgba(255, 255, 255, 0.9);">None</span>
                </div>
            </div>
        </div>

        <!-- Threat Statistics Tiles (v1.10.14 - Enterprise scalable architecture) -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 12px;">
            <!-- Critical Threats Tile -->
            <div onclick="showCriticalThreatsModal()" style="background: rgba(255, 180, 150, 0.12); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); color: #F2F0EF; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; border-top: 4px solid white;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0, 0, 0, 0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0, 0, 0, 0.1)'">
                <div style="font-size: 0.7em; opacity: 0.9; margin-bottom: 4px; font-weight: 500; letter-spacing: 0.3px; font-family: var(--font-primary);">CRITICAL THREATS</div>
                <div id="criticalValue" style="font-size: 1.8em; font-weight: 700; line-height: 1; font-family: var(--font-primary);">-</div>
                <div style="font-size: 0.65em; opacity: 0.8; margin-top: 3px; font-family: var(--font-secondary);">Click to view details</div>
                <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.3);">
                    <div style="font-size: 0.65em; opacity: 0.7; font-family: var(--font-secondary);">Latest</div>
                    <div id="criticalLatest" style="font-size: 0.7em; font-weight: 600; margin-top: 2px; font-family: var(--font-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">-</div>
                </div>
            </div>

            <!-- High Threats Tile (NEW v1.10.14) -->
            <div onclick="showHighThreatsModal()" style="background: rgba(255, 180, 150, 0.12); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); color: #F2F0EF; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; border-top: 4px solid white;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0, 0, 0, 0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0, 0, 0, 0.1)'">
                <div style="font-size: 0.7em; opacity: 0.9; margin-bottom: 4px; font-weight: 500; letter-spacing: 0.3px; font-family: var(--font-primary);">HIGH THREATS</div>
                <div id="highValue" style="font-size: 1.8em; font-weight: 700; line-height: 1; font-family: var(--font-primary);">-</div>
                <div style="font-size: 0.65em; opacity: 0.8; margin-top: 3px; font-family: var(--font-secondary);">Click to view details</div>
                <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.3);">
                    <div style="font-size: 0.65em; opacity: 0.7; font-family: var(--font-secondary);">Latest</div>
                    <div id="highLatest" style="font-size: 0.7em; font-weight: 600; margin-top: 2px; font-family: var(--font-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">-</div>
                </div>
            </div>

            <!-- Medium Threats Tile -->
            <div onclick="showMediumThreatsModal()" style="background: rgba(255, 180, 150, 0.12); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); color: #F2F0EF; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; border-top: 4px solid white;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0, 0, 0, 0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0, 0, 0, 0.1)'">
                <div style="font-size: 0.7em; opacity: 0.9; margin-bottom: 4px; font-weight: 500; letter-spacing: 0.3px; font-family: var(--font-primary);">MEDIUM THREATS</div>
                <div id="mediumValue" style="font-size: 1.8em; font-weight: 700; line-height: 1; font-family: var(--font-primary);">-</div>
                <div style="font-size: 0.65em; opacity: 0.8; margin-top: 3px; font-family: var(--font-secondary);">Click to view details</div>
                <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.3);">
                    <div style="font-size: 0.65em; opacity: 0.7; font-family: var(--font-secondary);">Latest</div>
                    <div id="mediumLatest" style="font-size: 0.7em; font-weight: 600; margin-top: 2px; font-family: var(--font-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">-</div>
                </div>
            </div>

            <!-- Blocked URLs Tile -->
            <div onclick="showBlockedUrlsModal()" style="background: rgba(255, 180, 150, 0.12); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); color: #F2F0EF; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; border-top: 4px solid white;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0, 0, 0, 0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0, 0, 0, 0.1)'">
                <div style="font-size: 0.7em; opacity: 0.9; margin-bottom: 4px; font-weight: 500; letter-spacing: 0.3px; font-family: var(--font-primary);">BLOCKED URLS</div>
                <div id="blockedUrlValue" style="font-size: 1.8em; font-weight: 700; line-height: 1; font-family: var(--font-primary);">-</div>
                <div style="font-size: 0.65em; opacity: 0.8; margin-top: 3px; font-family: var(--font-secondary);">Click to view details</div>
                <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.3);">
                    <div style="font-size: 0.65em; opacity: 0.7; font-family: var(--font-secondary);">Latest</div>
                    <div id="blockedUrlLatest" style="font-size: 0.7em; font-weight: 600; margin-top: 2px; font-family: var(--font-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">-</div>
                </div>
            </div>
        </div>

        <!-- Critical Threats Modal -->
        <div id="criticalThreatsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 1200px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <!-- Modal Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                    <div>
                        <h2 style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary);">Critical Threats</h2>
                        <p style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">Last 10 entries</p>
                    </div>
                    <button onclick="closeCriticalThreatsModal()" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1; font-family: var(--font-primary);">&times;</button>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Critical Threats</div>
                        <div id="criticalModalCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">0</div>
                    </div>
                </div>

                <!-- Threats Table -->
                <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                    <div style="max-height: 500px; overflow-y: auto;" id="criticalThreatsTableContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- High Threats Modal (NEW v1.10.14) -->
        <div id="highThreatsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 1200px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <!-- Modal Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #E04F26; padding-bottom: 15px;">
                    <div>
                        <h2 style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary);">High Threats</h2>
                        <p style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">Last 10 entries</p>
                    </div>
                    <button onclick="closeHighThreatsModal()" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1; font-family: var(--font-primary);">&times;</button>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #E04F26 0%, #FF6B3D 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total High Threats</div>
                        <div id="highModalCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">0</div>
                    </div>
                </div>

                <!-- Threats Table -->
                <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                    <div style="max-height: 500px; overflow-y: auto;" id="highThreatsTableContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Medium Threats Modal -->
        <div id="mediumThreatsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 1200px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <!-- Modal Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #C64620; padding-bottom: 15px;">
                    <div>
                        <h2 style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary);">Medium Threats</h2>
                        <p style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">Last 10 entries</p>
                    </div>
                    <button onclick="closeMediumThreatsModal()" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1; font-family: var(--font-primary);">&times;</button>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #E04F26 0%, #FF6B3D 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Medium Threats</div>
                        <div id="mediumModalCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">0</div>
                    </div>
                </div>

                <!-- Threats Table -->
                <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                    <div style="max-height: 500px; overflow-y: auto;" id="mediumThreatsTableContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Blocked URLs Modal -->
        <div id="blockedUrlsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 1200px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <!-- Modal Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #C64620; padding-bottom: 15px;">
                    <div>
                        <h2 style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary);">Blocked URLs</h2>
                        <p style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">Last 10 entries</p>
                    </div>
                    <button onclick="closeBlockedUrlsModal()" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1; font-family: var(--font-primary);">&times;</button>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #C64620 0%, #E85A31 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Blocked URLs</div>
                        <div id="blockedUrlsModalCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">0</div>
                    </div>
                </div>

                <!-- URLs Table -->
                <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                    <div style="max-height: 500px; overflow-y: auto;" id="blockedUrlsTableContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Top Applications Modal -->
        <div id="topAppsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 1200px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <!-- Modal Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #AD3D1A; padding-bottom: 15px;">
                    <div>
                        <h2 style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary);">Top Applications</h2>
                        <p style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">Most active applications by bandwidth usage</p>
                    </div>
                    <button onclick="closeTopAppsModal()" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1; font-family: var(--font-primary);">&times;</button>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #AD3D1A 0%, #D14925 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Applications</div>
                        <div id="topAppsModalCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">0</div>
                    </div>
                </div>

                <!-- Applications Table -->
                <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                    <div style="max-height: 500px; overflow-y: auto;" id="topAppsTableContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
        </div>
        </div>

        <!-- Connected Devices Content -->
        <div id="connected-devices-content" class="page-content" style="display: none;">
            <div class="container">
                <div class="header" style="text-align: left; margin-bottom: 30px;">
                    <h1 style="color: #F2F0EF; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0;">Connected Devices</h1>
                    <p style="color: #FA582D; font-size: 0.9em; margin: 0;">Devices Connected to the Firewall Network</p>
                </div>

                <div class="error-message" id="connectedDevicesErrorMessage"></div>

                <!-- Search and Filter Bar -->
                <div style="background: linear-gradient(135deg, #F2F0EF 0%, #E8E6E4 100%); border-radius: 12px; padding: 22px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); border: 3px solid #3c3c3c; border-top: 5px solid #FA582D;">
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">General Search</label>
                            <input type="text"
                                id="connectedDevicesSearchInput"
                                placeholder="Search by hostname, IP, MAC, vendor..."
                                style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; box-sizing: border-box; transition: border-color 0.3s; background: #F2F0EF;"
                                onfocus="this.style.borderColor='#FA582D'"
                                onblur="this.style.borderColor='#ddd'"
                            />
                        </div>
                        <div>
                            <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">VLAN Filter</label>
                            <select id="connectedDevicesVlanFilter" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: #F2F0EF; color: #333; font-size: 0.95em; cursor: pointer; transition: border-color 0.3s;" onfocus="this.style.borderColor='#ff6600'" onblur="this.style.borderColor='#ddd'">
                                <option value="">All VLANs</option>
                                <!-- Will be populated dynamically -->
                            </select>
                        </div>
                        <div>
                            <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">Security Zone Filter</label>
                            <select id="connectedDevicesZoneFilter" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: #F2F0EF; color: #333; font-size: 0.95em; cursor: pointer; transition: border-color 0.3s;" onfocus="this.style.borderColor='#ff6600'" onblur="this.style.borderColor='#ddd'">
                                <option value="">All Zones</option>
                                <!-- Will be populated dynamically -->
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; justify-content: space-between; gap: 15px; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <label style="color: #333; font-weight: 600; font-size: 0.9em;">Show:</label>
                                <select id="connectedDevicesLimit" style="padding: 8px 12px; border: 2px solid #ddd; border-radius: 6px; background: #F2F0EF; color: #333; font-size: 0.9em; cursor: pointer;">
                                    <option value="10">10 devices</option>
                                    <option value="25">25 devices</option>
                                    <option value="50" selected>50 devices</option>
                                    <option value="100">100 devices</option>
                                    <option value="250">250 devices</option>
                                    <option value="500">500 devices</option>
                                    <option value="-1">All devices</option>
                                </select>
                            </div>
                            <button id="refreshConnectedDevicesBtn" style="padding: 8px 16px; background: linear-gradient(135deg, #FA582D 0%, #C64620 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                Refresh
                            </button>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button id="exportDevicesCSV" style="padding: 8px 16px; background: linear-gradient(135deg, #C64620 0%, #AD3D1A 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                Export CSV
                            </button>
                            <button id="exportDevicesXML" style="padding: 8px 16px; background: linear-gradient(135deg, #AD3D1A 0%, #933414 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                Export XML
                            </button>
                        </div>
                    </div>
                </div>

                <div id="connectedDevicesTable"></div>
            </div>
        </div>

        <!-- Applications Content -->
        <div id="applications-content" class="page-content" style="display: none;">
            <div class="container">
                <div class="header" style="text-align: left; margin-bottom: 30px;">
                    <h1 style="color: #F2F0EF; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0;">Applications</h1>
                    <p style="color: #FA582D; font-size: 0.9em; margin: 0;">Application Traffic Analysis and Statistics</p>
                </div>

                <div class="error-message" id="applicationsErrorMessage"></div>

                <!-- Summary Statistics Tiles -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin-bottom: 20px;">
                    <!-- Total Applications Tile -->
                    <div style="background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(250, 88, 45, 0.3); color: #F2F0EF;">
                        <div style="font-size: 0.7em; opacity: 0.9; margin-bottom: 4px; font-weight: 500; letter-spacing: 0.3px;">TOTAL APPLICATIONS</div>
                        <div id="appStatTotalApps" style="font-size: 1.8em; font-weight: 700; line-height: 1;">-</div>
                        <div style="font-size: 0.65em; opacity: 0.8; margin-top: 3px;">Unique apps detected</div>
                    </div>

                    <!-- Total Traffic Volume Tile -->
                    <div style="background: linear-gradient(135deg, #C64620 0%, #E85A31 100%); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(198, 70, 32, 0.3); color: #F2F0EF;">
                        <div style="font-size: 0.7em; opacity: 0.9; margin-bottom: 4px; font-weight: 500; letter-spacing: 0.3px;">TRAFFIC VOLUME</div>
                        <div id="appStatTotalVolume" style="font-size: 1.8em; font-weight: 700; line-height: 1;">-</div>
                        <div style="font-size: 0.65em; opacity: 0.8; margin-top: 3px;">Data transferred</div>
                    </div>

                    <!-- VLANs Detected Tile -->
                    <div style="background: linear-gradient(135deg, #AD3D1A 0%, #D14925 100%); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(173, 61, 26, 0.3); color: #F2F0EF;">
                        <div style="font-size: 0.7em; opacity: 0.9; margin-bottom: 4px; font-weight: 500; letter-spacing: 0.3px;">VLANS DETECTED</div>
                        <div id="appStatVlans" style="font-size: 1.8em; font-weight: 700; line-height: 1;">-</div>
                        <div style="font-size: 0.65em; opacity: 0.8; margin-top: 3px;">Virtual networks</div>
                    </div>

                    <!-- Security Zones Detected Tile -->
                    <div style="background: linear-gradient(135deg, #943516 0%, #B94420 100%); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(148, 53, 22, 0.3); color: #F2F0EF;">
                        <div style="font-size: 0.7em; opacity: 0.9; margin-bottom: 4px; font-weight: 500; letter-spacing: 0.3px;">SECURITY ZONES DETECTED</div>
                        <div id="appStatZones" style="font-size: 1.8em; font-weight: 700; line-height: 1;">-</div>
                        <div style="font-size: 0.65em; opacity: 0.8; margin-top: 3px;">Policy zones</div>
                    </div>
                </div>

                <!-- Traffic by Category Chart -->
                <div style="background: white; border-radius: 12px; padding: 25px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-top: 3px solid #FA582D;">
                    <h3 style="color: #333; margin: 0 0 20px 0; font-size: 1.2em; font-weight: 600;">Traffic by Category</h3>
                    <div style="height: 300px; position: relative;">
                        <canvas id="trafficByCategoryChart"></canvas>
                    </div>
                </div>

                <!-- Search and Filter Bar -->
                <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-top: 3px solid #FA582D;">
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">Search Applications</label>
                            <input type="text"
                                id="applicationsSearchInput"
                                placeholder="Search by application name..."
                                style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; box-sizing: border-box; transition: border-color 0.3s;"
                                onfocus="this.style.borderColor='#FA582D'"
                                onblur="this.style.borderColor='#ddd'"
                            />
                        </div>
                        <div>
                            <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">Filter by VLAN</label>
                            <select id="applicationsVlanFilter" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer;">
                                <option value="">All VLANs</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">Filter by Zone</label>
                            <select id="applicationsZoneFilter" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer;">
                                <option value="">All Zones</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">Filter by Category</label>
                            <select id="applicationsCategoryFilter" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer;">
                                <option value="">All Categories</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">Show:</label>
                            <select id="applicationsLimit" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer;">
                                <option value="25">25 apps</option>
                                <option value="50" selected>50 apps</option>
                                <option value="100">100 apps</option>
                                <option value="250">250 apps</option>
                                <option value="-1">All</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                        <button id="refreshApplicationsBtn" style="padding: 8px 16px; background: linear-gradient(135deg, #FA582D 0%, #C64620 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                            Refresh
                        </button>
                        <button id="exportAppsCSVBtn" style="padding: 8px 16px; background: white; color: #FA582D; border: 2px solid #FA582D; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#FA582D'; this.style.color='white';" onmouseout="this.style.background='white'; this.style.color='#FA582D';">
                            Export CSV
                        </button>
                        <button id="exportAppsJSONBtn" style="padding: 8px 16px; background: white; color: #FA582D; border: 2px solid #FA582D; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#FA582D'; this.style.color='white';" onmouseout="this.style.background='white'; this.style.color='#FA582D';">
                            Export JSON
                        </button>
                        <label style="display: flex; align-items: center; gap: 6px; color: #333; font-size: 0.9em; cursor: pointer; user-select: none;">
                            <input type="checkbox" id="enableReverseDnsCheckbox" style="width: 16px; height: 16px; cursor: pointer; accent-color: #FA582D;">
                            <span style="font-weight: 500;">Enable Reverse DNS Lookups</span>
                        </label>
                        <span style="color: #666; font-size: 0.9em; margin-left: auto;" id="applicationsCount">Loading...</span>
                    </div>
                </div>

                <div id="applicationsTable"></div>
            </div>
        </div>

        <!-- Application Destinations Modal -->
        <div id="appDestinationsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <!-- Modal Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                    <div>
                        <h2 id="appDestModalTitle" style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary);">Application Destinations</h2>
                        <p id="appDestModalSubtitle" style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">Traffic destinations</p>
                    </div>
                    <button id="closeAppDestModalBtn" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1; font-family: var(--font-primary);">&times;</button>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #FA582D 0%, #E04F26 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Application</div>
                        <div id="appDestApp" style="font-size: 1.5em; font-weight: 700; word-break: break-word; font-family: var(--font-primary);">-</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #C64620 0%, #AD3D1A 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Destinations</div>
                        <div id="appDestCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">-</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #AD3D1A 0%, #933414 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Volume</div>
                        <div id="appDestVolume" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">-</div>
                    </div>
                </div>

                <!-- Destinations Table -->
                <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                    <h3 style="margin: 0 0 15px 0; color: #333; font-size: 1.1em; font-family: var(--font-primary);">Destination IP Addresses / Hosts</h3>
                    <div style="max-height: 400px; overflow-y: auto;">
                        <div id="appDestinationsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 10px;">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Note -->
                <div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
                    <p id="appDestNote" style="margin: 0; color: #856404; font-size: 0.9em; font-family: var(--font-secondary);">
                        Showing top destinations by volume
                    </p>
                </div>
            </div>
        </div>

        <!-- Application Details Modal -->
        <div id="appDetailsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <!-- Modal Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                    <div style="flex: 1;">
                        <h2 id="appDetailsName" style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary); font-size: 1.8em;">-</h2>
                        <p style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">Category: <span id="appDetailsCategory" style="color: #FA582D; font-weight: 600;">-</span></p>
                    </div>
                    <button id="closeAppDetailsModalBtn" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1; font-family: var(--font-primary);">&times;</button>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #E04F26 0%, #FF6B3D 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.75em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Volume</div>
                        <div id="appDetailsVolume" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">-</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #C64620 0%, #E85A31 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.75em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Source IPs</div>
                        <div id="appDetailsSourceIPs" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">-</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #AD3D1A 0%, #D14925 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.75em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Destinations</div>
                        <div id="appDetailsDestinations" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">-</div>
                    </div>
                </div>

                <!-- Source IP Addresses Section -->
                <div style="background: #f9f9f9; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 15px 0; color: #333; font-size: 1.1em; font-family: var(--font-primary); font-weight: 600;">Source IP Addresses</h3>
                    <div id="appDetailsSourceList" style="display: flex; flex-wrap: wrap; gap: 10px;">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Three Column Section: Protocols, Top Ports, VLANs -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <!-- Protocols -->
                    <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                        <h3 style="margin: 0 0 15px 0; color: #333; font-size: 1em; font-family: var(--font-primary); font-weight: 600; text-transform: uppercase;">Protocols</h3>
                        <div id="appDetailsProtocols" style="font-family: monospace; color: #666; font-size: 0.95em;">-</div>
                    </div>

                    <!-- Top Ports -->
                    <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                        <h3 style="margin: 0 0 15px 0; color: #333; font-size: 1em; font-family: var(--font-primary); font-weight: 600; text-transform: uppercase;">Top Ports</h3>
                        <div id="appDetailsTopPorts" style="font-family: monospace; color: #666; font-size: 0.95em;">-</div>
                    </div>

                    <!-- VLANs -->
                    <div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
                        <h3 style="margin: 0 0 15px 0; color: #333; font-size: 1em; font-family: var(--font-primary); font-weight: 600; text-transform: uppercase;">VLANs</h3>
                        <div id="appDetailsVLANs" style="font-family: monospace; color: #666; font-size: 0.95em;">-</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Traffic Flow Sankey Diagram Modal -->
        <div id="sankeyModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; justify-content: center; align-items: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 1400px; width: 95%; max-height: 95vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.5);">
                <!-- Modal Header -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                    <div>
                        <h2 style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary);">Traffic Flow Breakdown</h2>
                        <p id="sankeyClientInfo" style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">Source: <span style="font-weight: 600; color: #FA582D;">-</span></p>
                    </div>
                    <button id="closeSankeyModalBtn" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1; font-family: var(--font-primary);">&times;</button>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #FA582D 0%, #E04F26 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Flows</div>
                        <div id="sankeyTotalFlows" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">-</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #C64620 0%, #AD3D1A 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Volume</div>
                        <div id="sankeyTotalVolume" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">-</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #AD3D1A 0%, #933414 100%); border-radius: 8px; padding: 15px; color: #F2F0EF;">
                        <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Time Range</div>
                        <div id="sankeyTimeRange" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">60 min</div>
                    </div>
                </div>

                <!-- Sankey Diagram Container -->
                <div style="background: #f9f9f9; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <div id="sankeyDiagram" style="width: 100%; height: 800px; overflow: visible;">
                        <!-- SVG will be rendered here by d3-sankey -->
                    </div>
                </div>

                <!-- Loading State -->
                <div id="sankeyLoading" style="display: none; text-align: center; padding: 60px 20px;">
                    <div style="margin: 0 auto 20px auto; width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #FA582D; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                    <p style="color: #666; font-size: 1.1em; font-family: var(--font-secondary);">Loading traffic flow data...</p>
                </div>

                <!-- Error State -->
                <div id="sankeyError" style="display: none; padding: 20px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
                    <p style="margin: 0; color: #856404; font-size: 0.9em; font-family: var(--font-secondary);">
                        <strong>Unable to load traffic flow data.</strong> <span id="sankeyErrorMessage"></span>
                    </p>
                </div>

                <!-- Note -->
                <div style="padding: 10px; background: #e7f3ff; border-left: 4px solid #2196F3; border-radius: 4px;">
                    <p style="margin: 0; color: #0d47a1; font-size: 0.9em; font-family: var(--font-secondary);">
                        <strong>Flow visualization:</strong> Shows source → destination → application connections.
                        Link width represents traffic volume. Data collected every 60 seconds from firewall.
                    </p>
                </div>
            </div>
        </div>

        <!-- Device Info Content (Combined Policies and Software Updates) -->
        <div id="device-info-content" class="page-content" style="display: none;">
            <div class="container">
                <div class="header" style="text-align: left; margin-bottom: 30px;">
                    <h1 style="color: #F2F0EF; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0;">Device Info</h1>
                    <p style="color: #FA582D; font-size: 0.9em; margin: 0;">Firewall Software and Technical Support</p>
                </div>

                <!-- Tab Navigation -->
                <div style="display: flex; gap: 10px; margin-bottom: 30px; border-bottom: 2px solid rgba(250, 88, 45, 0.3);">
                    <button class="device-info-tab active" data-tab="interfaces" style="padding: 12px 24px; background: transparent; border: none; color: #FA582D; font-size: 1em; font-weight: 600; cursor: pointer; border-bottom: 3px solid #FA582D; transition: all 0.3s;">
                        Interfaces
                    </button>
                    <button class="device-info-tab" data-tab="dhcp" style="padding: 12px 24px; background: transparent; border: none; color: rgba(255, 255, 255, 0.6); font-size: 1em; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;">
                        DHCP
                    </button>
                    <button class="device-info-tab" data-tab="software-updates" style="padding: 12px 24px; background: transparent; border: none; color: rgba(255, 255, 255, 0.6); font-size: 1em; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;">
                        Software Updates
                    </button>
                    <button class="device-info-tab" data-tab="tech-support" style="padding: 12px 24px; background: transparent; border: none; color: rgba(255, 255, 255, 0.6); font-size: 1em; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;">
                        Tech Support
                    </button>
                    <button class="device-info-tab" data-tab="reboot" style="padding: 12px 24px; background: transparent; border: none; color: rgba(255, 255, 255, 0.6); font-size: 1em; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;">
                        Reboot
                    </button>
                </div>

                <!-- Interfaces Tab Content -->
                <div id="interfaces-tab" class="device-info-tab-content" style="display: block;">
                    <div class="error-message" id="interfacesErrorMessage"></div>

                    <div id="interfacesLoading" style="display: none; text-align: center; padding: 60px 20px; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <div class="spinner" style="margin: 0 auto 20px auto; width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #F7D9BC; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                        <p style="color: #666; font-size: 1.1em; font-family: var(--font-secondary);">Loading interface information...</p>
                    </div>

                    <div id="interfacesContent" style="display: none;">
                        <!-- Summary Statistics -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                            <div style="background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(250, 88, 45, 0.3); color: #F2F0EF;">
                                <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Total Interfaces</div>
                                <div id="interfacesTotalCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">0</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #C64620 0%, #E85A31 100%); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(198, 70, 32, 0.3); color: #F2F0EF;">
                                <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Interfaces Up</div>
                                <div id="interfacesUpCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">0</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #AD3D1A 0%, #D14925 100%); border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(173, 61, 26, 0.3); color: #F2F0EF;">
                                <div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px; font-family: var(--font-secondary);">Interfaces Down</div>
                                <div id="interfacesDownCount" style="font-size: 1.8em; font-weight: 700; font-family: var(--font-primary);">0</div>
                            </div>
                        </div>

                        <!-- Interfaces Table -->
                        <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-top: 3px solid #FA582D;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <h3 style="color: #333; margin: 0; font-size: 1.2em; font-weight: 600; font-family: var(--font-primary);">Interface Details</h3>
                                    <select id="interfaceStateFilter" onchange="applyInterfaceFilter()" style="padding: 8px 12px; border: 2px solid #FA582D; border-radius: 6px; font-size: 0.9em; font-family: var(--font-primary); color: #333; cursor: pointer; background: white;">
                                        <option value="all">All Interfaces</option>
                                        <option value="up" selected>Up Only</option>
                                        <option value="down">Down Only</option>
                                    </select>
                                </div>
                                <button onclick="loadInterfaces()" style="padding: 8px 16px; background: linear-gradient(135deg, #FA582D 0%, #C64620 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; font-family: var(--font-primary); transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                    Refresh
                                </button>
                            </div>
                            <div id="interfacesTable" style="overflow-x: auto;">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- DHCP Tab Content -->
                <div id="dhcp-tab" class="device-info-tab-content" style="display: none;">
                    <div class="error-message" id="dhcpErrorMessage"></div>

                    <div id="dhcpLoading" style="display: none; text-align: center; padding: 60px 20px; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <div class="spinner" style="margin: 0 auto 20px auto; width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #F7D9BC; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                        <p style="color: #666; font-family: var(--font-secondary); font-size: 1em;">Loading DHCP leases...</p>
                    </div>

                    <div id="dhcpContent" style="display: none;">
                        <!-- Summary Section -->
                        <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <h3 style="color: #333; font-family: var(--font-primary); margin: 0 0 10px 0;">DHCP Summary</h3>
                            <div style="display: flex; gap: 30px; flex-wrap: wrap;">
                                <div>
                                    <p style="color: #999; font-size: 0.85em; margin: 0; font-family: var(--font-secondary);">Total Active Leases</p>
                                    <p id="dhcpTotalLeases" style="color: #FA582D; font-size: 1.8em; font-weight: 700; margin: 5px 0 0 0; font-family: var(--font-primary);">0</p>
                                </div>
                            </div>
                        </div>

                        <!-- DHCP Leases Table -->
                        <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <h3 style="color: #333; font-family: var(--font-primary); margin: 0 0 20px 0;">Active DHCP Leases</h3>

                            <!-- Search and Filter Controls (v1.10.13) -->
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                                <div>
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em; font-family: var(--font-primary);">Search</label>
                                    <input type="text"
                                        id="dhcpSearchInput"
                                        placeholder="Search by IP, MAC, hostname..."
                                        oninput="renderDhcpTable()"
                                        style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; box-sizing: border-box; transition: border-color 0.3s; font-family: var(--font-secondary);"
                                        onfocus="this.style.borderColor='#FA582D'"
                                        onblur="this.style.borderColor='#ddd'"
                                    />
                                </div>
                                <div>
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em; font-family: var(--font-primary);">Filter by Interface</label>
                                    <select id="dhcpInterfaceFilter"
                                        onchange="renderDhcpTable()"
                                        style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer; font-family: var(--font-secondary);">
                                        <option value="">All Interfaces</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em; font-family: var(--font-primary);">Filter by State</label>
                                    <select id="dhcpStateFilter"
                                        onchange="renderDhcpTable()"
                                        style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer; font-family: var(--font-secondary);">
                                        <option value="">All States</option>
                                        <option value="BOUND">BOUND</option>
                                        <option value="OFFERED">OFFERED</option>
                                        <option value="EXPIRED">EXPIRED</option>
                                        <option value="UNKNOWN">UNKNOWN</option>
                                    </select>
                                </div>
                            </div>

                            <div style="overflow-x: auto;">
                                <table id="dhcpLeasesTable" style="width: 100%; border-collapse: collapse; font-family: var(--font-secondary);">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #FA582D 0%, #ff7849 100%); color: #F2F0EF;">
                                            <th onclick="sortDhcpLeases('ip')" style="padding: 12px; text-align: left; font-weight: 600; font-family: var(--font-primary); cursor: pointer; user-select: none;">
                                                <span id="dhcpHeaderIp">IP Address ▲</span>
                                            </th>
                                            <th onclick="sortDhcpLeases('mac')" style="padding: 12px; text-align: left; font-weight: 600; font-family: var(--font-primary); cursor: pointer; user-select: none;">
                                                <span id="dhcpHeaderMac">MAC Address</span>
                                            </th>
                                            <th onclick="sortDhcpLeases('hostname')" style="padding: 12px; text-align: left; font-weight: 600; font-family: var(--font-primary); cursor: pointer; user-select: none;">
                                                <span id="dhcpHeaderHostname">Hostname</span>
                                            </th>
                                            <th onclick="sortDhcpLeases('state')" style="padding: 12px; text-align: left; font-weight: 600; font-family: var(--font-primary); cursor: pointer; user-select: none;">
                                                <span id="dhcpHeaderState">State</span>
                                            </th>
                                            <th onclick="sortDhcpLeases('expiration')" style="padding: 12px; text-align: left; font-weight: 600; font-family: var(--font-primary); cursor: pointer; user-select: none;">
                                                <span id="dhcpHeaderExpiration">Expiration</span>
                                            </th>
                                            <th onclick="sortDhcpLeases('interface')" style="padding: 12px; text-align: left; font-weight: 600; font-family: var(--font-primary); cursor: pointer; user-select: none;">
                                                <span id="dhcpHeaderInterface">Interface</span>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="dhcpLeasesTableBody">
                                        <!-- Table rows will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Empty State -->
                            <div id="dhcpEmptyState" style="display: none; text-align: center; padding: 40px 20px;">
                                <p style="color: #999; font-family: var(--font-secondary); font-size: 1em; margin: 0;">No active DHCP leases found</p>
                                <p style="color: #ccc; font-family: var(--font-secondary); font-size: 0.9em; margin: 10px 0 0 0;">The DHCP server may not be configured or no devices have active leases.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Software Updates Tab Content -->
                <div id="software-updates-tab" class="device-info-tab-content" style="display: none;">
                    <div class="error-message" id="softwareErrorMessage"></div>

                    <!-- Sub-tabs for PAN-OS and Components -->
                    <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid rgba(250, 88, 45, 0.2);">
                        <button class="software-sub-tab active" data-tab="panos" style="padding: 10px 20px; background: transparent; border: none; color: #FA582D; font-size: 0.95em; font-weight: 600; cursor: pointer; border-bottom: 3px solid #FA582D; transition: all 0.3s; font-family: var(--font-primary);">
                            PAN-OS
                        </button>
                        <button class="software-sub-tab" data-tab="components" style="padding: 10px 20px; background: transparent; border: none; color: rgba(255, 255, 255, 0.6); font-size: 0.95em; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s; font-family: var(--font-primary);">
                            Components
                        </button>
                    </div>

                    <div id="softwareLoading" style="display: none; text-align: center; padding: 60px 20px; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <div class="spinner" style="margin: 0 auto 20px auto; width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #F7D9BC; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                        <p style="color: #666; font-size: 1.1em;">Loading software updates...</p>
                    </div>

                    <!-- PAN-OS Sub-tab Content -->
                    <div id="panos-sub-tab" class="software-sub-tab-content" style="display: block;">
                        <!-- Version Check Section -->
                        <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <h3 style="color: #333; font-family: var(--font-primary); margin: 0 0 15px 0;">PAN-OS Upgrade</h3>
                            <p style="color: #666; font-family: var(--font-secondary); margin: 0 0 15px 0; font-size: 0.95em;">
                                Check for available PAN-OS updates and upgrade your firewall to the latest version.
                            </p>
                            <button id="checkPanosVersionBtn" style="padding: 10px 20px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-family: var(--font-primary); box-shadow: 0 2px 4px rgba(250, 88, 45, 0.3); transition: all 0.3s;">
                                Check for Updates
                            </button>
                            <div id="panosVersionInfo"></div>
                        </div>

                        <!-- Current Version Table -->
                        <div id="panosTable" style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"></div>
                    </div>

                    <!-- Components Sub-tab Content -->
                    <div id="components-sub-tab" class="software-sub-tab-content" style="display: none;">
                        <!-- Content Update Management Section -->
                        <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <h3 style="color: #333; font-family: var(--font-primary); margin: 0 0 10px 0;">Content Updates</h3>
                            <p style="color: #666; font-family: var(--font-secondary); margin: 0 0 15px 0; font-size: 0.95em;">
                                Manage content updates for Applications & Threats, Antivirus, and WildFire. No reboot required.
                            </p>
                            <button id="checkContentUpdatesBtn" style="padding: 10px 20px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-family: var(--font-primary); box-shadow: 0 2px 4px rgba(250, 88, 45, 0.3); transition: all 0.3s;">
                                Check for Updates
                            </button>
                            <div id="contentUpdateInfo" style="display: none;"></div>
                        </div>

                        <!-- Current Components Table -->
                        <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <h3 style="color: #333; font-family: var(--font-primary); margin: 0 0 15px 0;">Current Software Components</h3>
                            <div id="componentsTable"></div>
                        </div>
                    </div>
                </div>

                <!-- Tech Support Tab Content -->
                <div id="tech-support-tab" class="device-info-tab-content" style="display: none;">
                    <div class="error-message" id="techSupportErrorMessage"></div>

                    <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <div style="margin-bottom: 20px;">
                            <h3 style="color: #333; font-family: 'Roboto', sans-serif; margin: 0 0 10px 0;">Generate Tech Support File</h3>
                            <p style="color: #666; font-family: 'Open Sans', sans-serif; margin: 0 0 20px 0;">
                                Generate a comprehensive technical support file from your Palo Alto firewall. This file contains diagnostic information that can be shared with support teams.
                            </p>
                            <button id="generateTechSupportBtn" onclick="generateTechSupport()" style="background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; padding: 12px 30px; border-radius: 6px; font-size: 1em; font-weight: 600; cursor: pointer; font-family: 'Roboto', sans-serif; box-shadow: 0 2px 4px rgba(250, 88, 45, 0.3); transition: all 0.3s;">
                                Generate Tech Support File
                            </button>
                        </div>

                        <!-- Progress/Status Area -->
                        <div id="techSupportStatus" style="display: none; margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 8px; border-left: 4px solid #FA582D;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div class="spinner" id="techSupportSpinner" style="width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #F7D9BC; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                                <div style="flex: 1;">
                                    <p id="techSupportStatusText" style="color: #333; font-weight: 600; margin: 0 0 5px 0; font-family: 'Roboto', sans-serif;">Generating tech support file...</p>
                                    <p id="techSupportProgressText" style="color: #666; margin: 0; font-size: 0.9em; font-family: 'Open Sans', sans-serif;">Please wait, this may take several minutes.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Download Area -->
                        <div id="techSupportDownload" style="display: none; margin-top: 30px; padding: 20px; background: #e8f5e9; border-radius: 8px; border-left: 4px solid #28a745;">
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <div>
                                    <p style="color: #28a745; font-weight: 600; margin: 0 0 5px 0; font-family: 'Roboto', sans-serif;">✓ Tech support file ready!</p>
                                    <p id="techSupportFileName" style="color: #666; margin: 0; font-size: 0.9em; font-family: 'Open Sans', sans-serif;"></p>
                                </div>
                                <a id="techSupportDownloadLink" href="#" target="_blank" style="background: #28a745; color: #F2F0EF; border: none; padding: 10px 24px; border-radius: 6px; text-decoration: none; font-weight: 600; font-family: 'Roboto', sans-serif; box-shadow: 0 2px 4px rgba(40, 167, 69, 0.3);">
                                    Download File
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reboot Tab Content -->
                <div id="reboot-tab" class="device-info-tab-content" style="display: none;">
                    <div class="error-message" id="rebootErrorMessage"></div>

                    <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <div style="margin-bottom: 20px;">
                            <h3 style="color: #333; font-family: var(--font-primary); margin: 0 0 10px 0;">Reboot Firewall</h3>
                            <p style="color: #666; font-family: var(--font-secondary); margin: 0 0 20px 0;">
                                Restart the Palo Alto firewall to apply configuration changes or resolve issues. The firewall will be unavailable for several minutes during the reboot process.
                            </p>

                            <!-- Warning Box -->
                            <div style="padding: 15px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; margin-bottom: 20px;">
                                <strong style="color: #856404; font-family: var(--font-primary);">Warning:</strong>
                                <p style="margin: 5px 0 0 0; color: #856404; font-family: var(--font-secondary); font-size: 0.95em;">
                                    Rebooting the firewall will:
                                </p>
                                <ul style="margin: 8px 0 0 20px; color: #856404; font-family: var(--font-secondary); font-size: 0.95em;">
                                    <li>Disconnect all active network traffic</li>
                                    <li>Interrupt all VPN connections</li>
                                    <li>Make the firewall management interface unavailable</li>
                                    <li>Typically take 5-10 minutes to complete</li>
                                </ul>
                            </div>

                            <!-- Reboot Button -->
                            <button id="rebootFirewallBtn" onclick="initiateReboot()" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: #F2F0EF; border: none; padding: 12px 30px; border-radius: 6px; font-size: 1em; font-weight: 600; cursor: pointer; font-family: var(--font-primary); box-shadow: 0 2px 4px rgba(220, 53, 69, 0.3); transition: all 0.3s;">
                                Reboot Firewall
                            </button>
                        </div>

                        <!-- Status Area -->
                        <div id="rebootStatus" style="display: none; margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 8px; border-left: 4px solid #FA582D;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div class="spinner" id="rebootSpinner" style="width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #F7D9BC; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                                <div style="flex: 1;">
                                    <p id="rebootStatusText" style="color: #333; font-weight: 600; margin: 0 0 5px 0; font-family: var(--font-primary);">Rebooting firewall...</p>
                                    <p id="rebootProgressText" style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">The firewall is restarting. This page will be unavailable for several minutes.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Success Area -->
                        <div id="rebootSuccess" style="display: none; margin-top: 30px; padding: 20px; background: #d4edda; border-radius: 8px; border-left: 4px solid #28a745;">
                            <p style="color: #28a745; font-weight: 600; margin: 0 0 5px 0; font-family: var(--font-primary);">✓ Reboot command sent successfully!</p>
                            <p style="color: #666; margin: 0; font-size: 0.9em; font-family: var(--font-secondary);">The firewall is now rebooting. You may lose connection shortly.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logs Content (Combined System and Traffic Logs) -->
        <div id="logs-content" class="page-content" style="display: none;">
            <div class="container">
                <div class="header" style="text-align: left; margin-bottom: 30px;">
                    <h1 style="color: #F2F0EF; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0;">Logs</h1>
                    <p style="color: #FA582D; font-size: 0.9em; margin: 0;">System Events and Network Traffic Logs</p>
                </div>

                <!-- Tab Navigation -->
                <div style="display: flex; gap: 10px; margin-bottom: 30px; border-bottom: 2px solid rgba(250, 88, 45, 0.3);">
                    <button class="logs-tab active" data-tab="system-logs" style="padding: 12px 24px; background: transparent; border: none; color: #FA582D; font-size: 1em; font-weight: 600; cursor: pointer; border-bottom: 3px solid #FA582D; transition: all 0.3s;">
                        System Logs
                    </button>
                    <button class="logs-tab" data-tab="traffic-logs" style="padding: 12px 24px; background: transparent; border: none; color: rgba(255, 255, 255, 0.6); font-size: 1em; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;">
                        Traffic Logs
                    </button>
                </div>

                <!-- System Logs Tab Content -->
                <div id="system-logs-tab" class="logs-tab-content">
                    <div class="error-message" id="systemLogsErrorMessage"></div>

                    <!-- Search Box -->
                    <div style="margin-bottom: 20px;">
                        <input type="text"
                            id="systemLogsSearchInput"
                            placeholder="Search by time, severity, module, event ID, or description..."
                            style="width: 100%; padding: 12px 15px; border: 2px solid #FA582D; border-radius: 8px; font-size: 0.95em; box-sizing: border-box;"
                        />
                    </div>

                    <!-- Sort and Filter Controls -->
                    <div style="margin-bottom: 20px; display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="color: #F2F0EF; font-weight: 600;">Sort by:</label>
                            <select id="systemLogsSortBy" style="padding: 8px 12px; border: 2px solid #FA582D; border-radius: 6px; background: white; color: #333; font-size: 0.9em; cursor: pointer;">
                                <option value="time">Time (Newest First)</option>
                                <option value="time-asc">Time (Oldest First)</option>
                                <option value="severity">Severity (High to Low)</option>
                                <option value="severity-asc">Severity (Low to High)</option>
                                <option value="module">Module (A-Z)</option>
                                <option value="eventid">Event ID</option>
                            </select>
                        </div>

                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="color: #F2F0EF; font-weight: 600;">Filter by Severity:</label>
                            <select id="systemLogsFilterSeverity" style="padding: 8px 12px; border: 2px solid #FA582D; border-radius: 6px; background: white; color: #333; font-size: 0.9em; cursor: pointer;">
                                <option value="all">All Severities</option>
                                <option value="critical">Critical Only</option>
                                <option value="high">High Only</option>
                                <option value="medium">Medium Only</option>
                                <option value="low">Low Only</option>
                                <option value="informational">Informational Only</option>
                            </select>
                        </div>
                    </div>

                    <div id="systemLogsTable"></div>
                </div>

                <!-- Traffic Logs Tab Content -->
                <div id="traffic-logs-tab" class="logs-tab-content" style="display: none;">
                    <div class="error-message" id="trafficLogsErrorMessage"></div>
                    <div id="trafficLogsTable"></div>
                </div>
            </div>
        </div>

        <!-- Alerts Content -->
        <div id="alerts-content" class="page-content" style="display: none;">
            <div class="container">
                <div class="header" style="text-align: left; margin-bottom: 30px;">
                    <h1 style="color: #F2F0EF; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0; font-family: var(--font-primary);">Alert Management</h1>
                    <p style="color: #FA582D; font-size: 0.9em; margin: 0; font-family: var(--font-secondary);">Configure and Monitor Firewall Alerts</p>
                </div>

                <!-- Alert Statistics Tiles - Three Severity Cards -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    <!-- INFO Card (Blue) -->
                    <div onclick="showInfoAlertsModal()" style="background: linear-gradient(135deg, #17a2b8 0%, #20c0d7 100%); color: #F2F0EF; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(23, 162, 184, 0.4); cursor: pointer; transition: transform 0.2s; display: flex; justify-content: space-between; align-items: center; min-height: 100px;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                        <div style="flex-shrink: 0; flex-basis: 50%;">
                            <div style="font-size: 0.9em; opacity: 0.95; margin-bottom: 8px; font-family: var(--font-primary); text-shadow: 0 1px 2px rgba(0,0,0,0.2);">INFO</div>
                            <div id="alertStatsInfo" style="font-size: 2.5em; font-weight: 700; font-family: var(--font-primary); text-shadow: 0 1px 3px rgba(0,0,0,0.3);">0</div>
                        </div>
                        <div id="alertLatestInfo" style="font-size: 1.1em; line-height: 1.4; font-family: var(--font-secondary); text-shadow: 0 1px 2px rgba(0,0,0,0.3); font-weight: 600; text-align: right; flex-basis: 50%; max-width: 50%; word-wrap: break-word; overflow-wrap: break-word;">No active alerts</div>
                    </div>

                    <!-- WARNING Card (Yellow/Orange) -->
                    <div onclick="showWarningAlertsModal()" style="background: linear-gradient(135deg, #ffc107 0%, #ffcd39 100%); color: #1a1a1a; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(255, 193, 7, 0.4); cursor: pointer; transition: transform 0.2s; display: flex; justify-content: space-between; align-items: center; min-height: 100px;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                        <div style="flex-shrink: 0; flex-basis: 50%;">
                            <div style="font-size: 0.9em; opacity: 0.85; margin-bottom: 8px; font-family: var(--font-primary); font-weight: 600;">WARNING</div>
                            <div id="alertStatsWarning" style="font-size: 2.5em; font-weight: 700; font-family: var(--font-primary);">0</div>
                        </div>
                        <div id="alertLatestWarning" style="font-size: 1.1em; line-height: 1.4; font-family: var(--font-secondary); opacity: 0.9; font-weight: 700; text-align: right; flex-basis: 50%; max-width: 50%; word-wrap: break-word; overflow-wrap: break-word;">No active alerts</div>
                    </div>

                    <!-- CRITICAL Card (Red) -->
                    <div onclick="showCriticalAlertsModal()" style="background: linear-gradient(135deg, #dc3545 0%, #e45663 100%); color: #F2F0EF; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4); cursor: pointer; transition: transform 0.2s; display: flex; justify-content: space-between; align-items: center; min-height: 100px;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                        <div style="flex-shrink: 0; flex-basis: 50%;">
                            <div style="font-size: 0.9em; opacity: 0.95; margin-bottom: 8px; font-family: var(--font-primary); text-shadow: 0 1px 2px rgba(0,0,0,0.2);">CRITICAL</div>
                            <div id="alertStatsCritical" style="font-size: 2.5em; font-weight: 700; font-family: var(--font-primary); text-shadow: 0 1px 3px rgba(0,0,0,0.3);">0</div>
                        </div>
                        <div id="alertLatestCritical" style="font-size: 1.1em; line-height: 1.4; font-family: var(--font-secondary); text-shadow: 0 1px 2px rgba(0,0,0,0.3); font-weight: 600; text-align: right; flex-basis: 50%; max-width: 50%; word-wrap: break-word; overflow-wrap: break-word;">No active alerts</div>
                    </div>
                </div>

                <!-- Quick Actions Section -->
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 25px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button onclick="showCreateAlertModal()" style="padding: 20px; background: linear-gradient(135deg, #E8491D 0%, #FA582D 100%); color: #F2F0EF; border: none; border-radius: 10px; font-size: 1.05em; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 12px rgba(232, 73, 29, 0.3); font-family: var(--font-primary);">
                            Create Metric Alert
                        </button>
                        <button onclick="showAlertHistoryFullModal()" style="padding: 20px; background: linear-gradient(135deg, #B8541E 0%, #D96534 100%); color: #F2F0EF; border: none; border-radius: 10px; font-size: 1.05em; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 12px rgba(184, 84, 30, 0.3); font-family: var(--font-primary);">
                            View Alert History
                        </button>
                        <button onclick="showQuickStartModal()" style="padding: 20px; background: linear-gradient(135deg, #C23C14 0%, #D94A1F 100%); color: #F2F0EF; border: none; border-radius: 10px; font-size: 1.05em; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 12px rgba(194, 60, 20, 0.3); font-family: var(--font-primary);">
                            Quick Start Setup
                        </button>
                    </div>
                </div>

                <!-- My Alert Configurations -->
                <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC; margin-bottom: 25px;">
                    <h2 style="color: #333; margin: 0 0 20px 0; font-size: 1.4em; font-family: var(--font-primary);">My Alert Configurations</h2>
                    <div id="alertConfigsTable" style="font-family: var(--font-secondary);"></div>
                </div>
            </div>
        </div>

        <!-- Analytics Content -->
        <div id="analytics-content" class="page-content" style="display: none;">
            <div class="container">
                <div class="header" style="text-align: left; margin-bottom: 30px;">
                    <h1 style="color: #F2F0EF; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0; font-family: var(--font-primary);">Insights Dashboard</h1>
                    <p style="color: #FA582D; font-size: 0.9em; margin: 0; font-family: var(--font-secondary);">Historical Data and Insights</p>
                </div>

                <!-- Time Range Controls -->
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 25px;">
                    <div style="display: grid; grid-template-columns: auto 1fr auto; gap: 20px; align-items: center;">
                        <div>
                            <label style="font-weight: 600; font-family: var(--font-primary); margin-right: 10px;">Time Range:</label>
                            <select id="analyticsTimeRange" onchange="loadAnalyticsData()" style="padding: 10px 15px; border: 2px solid #FA582D; border-radius: 6px; font-size: 1em; font-family: var(--font-secondary); cursor: pointer;">
                                <option value="1h">Last 1 Hour</option>
                                <option value="6h">Last 6 Hours</option>
                                <option value="24h" selected>Last 24 Hours</option>
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                        <div style="text-align: center;">
                            <span id="analyticsDataRange" style="color: #666; font-family: var(--font-secondary);"></span>
                        </div>
                        <div>
                            <button onclick="exportAnalyticsCSV()" style="padding: 10px 20px; background: linear-gradient(135deg, #28a745 0%, #34ce57 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary); margin-right: 10px;">
                                📥 Export CSV
                            </button>
                            <button onclick="refreshAnalyticsData()" style="padding: 10px 20px; background: linear-gradient(135deg, #17a2b8 0%, #20c9e0 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary); margin-right: 10px;">
                                🔄 Refresh
                            </button>
                            <button onclick="openEnhancedInsightsModal()" style="padding: 10px 20px; background: linear-gradient(135deg, #FA582D 0%, #E04F26 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary); box-shadow: 0 2px 8px rgba(250,88,45,0.3);">
                                ⚡ Enhanced Insights
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Peak Usage Statistics -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #FA582D;">
                        <h3 style="color: #666; font-size: 0.9em; margin: 0 0 10px 0; font-family: var(--font-primary);">PEAK THROUGHPUT</h3>
                        <div id="analyticsPeakThroughput" style="font-size: 2em; font-weight: 700; color: #FA582D; font-family: var(--font-primary);">--</div>
                        <div id="analyticsPeakTime" style="color: #999; font-size: 0.85em; margin-top: 5px; font-family: var(--font-secondary);"></div>
                    </div>
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #E04F26;">
                        <h3 style="color: #666; font-size: 0.9em; margin: 0 0 10px 0; font-family: var(--font-primary);">AVERAGE THROUGHPUT</h3>
                        <div id="analyticsAvgThroughput" style="font-size: 2em; font-weight: 700; color: #E04F26; font-family: var(--font-primary);">--</div>
                        <div style="color: #999; font-size: 0.85em; margin-top: 5px; font-family: var(--font-secondary);">Total (In + Out)</div>
                    </div>
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #B8541E;">
                        <h3 style="color: #666; font-size: 0.9em; margin: 0 0 10px 0; font-family: var(--font-primary);">PEAK SESSIONS</h3>
                        <div id="analyticsPeakSessions" style="font-size: 2em; font-weight: 700; color: #B8541E; font-family: var(--font-primary);">--</div>
                        <div id="analyticsPeakSessionsTime" style="color: #999; font-size: 0.85em; margin-top: 5px; font-family: var(--font-secondary);"></div>
                    </div>
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #C23C14;">
                        <h3 style="color: #666; font-size: 0.9em; margin: 0 0 10px 0; font-family: var(--font-primary);">DATA SAMPLES</h3>
                        <div id="analyticsSampleCount" style="font-size: 2em; font-weight: 700; color: #C23C14; font-family: var(--font-primary);">--</div>
                        <div style="color: #999; font-size: 0.85em; margin-top: 5px; font-family: var(--font-secondary);">Records in range</div>
                    </div>
                </div>

                <!-- Historical Throughput Chart -->
                <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC; margin-bottom: 25px;">
                    <h2 style="color: #333; margin: 0 0 20px 0; font-size: 1.4em; font-family: var(--font-primary);">Throughput History</h2>
                    <div style="position: relative; height: 400px;">
                        <canvas id="analyticsChart"></canvas>
                    </div>
                </div>

                <!-- CPU & Memory Charts -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
                    <!-- CPU Chart -->
                    <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC;">
                        <h2 style="color: #333; margin: 0 0 20px 0; font-size: 1.4em; font-family: var(--font-primary);">CPU Usage History</h2>
                        <div style="position: relative; height: 300px;">
                            <canvas id="analyticsCpuChart"></canvas>
                        </div>
                        <!-- CPU Stats -->
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px;">
                            <div style="text-align: center; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">AVG DATA PLANE</div>
                                <div id="avgCpuDataPlane" style="font-size: 1.5em; font-weight: 700; color: #E04F26; font-family: var(--font-primary);">--</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">PEAK DATA PLANE</div>
                                <div id="peakCpuDataPlane" style="font-size: 1.5em; font-weight: 700; color: #E04F26; font-family: var(--font-primary);">--</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">AVG MGMT PLANE</div>
                                <div id="avgCpuMgmt" style="font-size: 1.5em; font-weight: 700; color: #B8541E; font-family: var(--font-primary);">--</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">PEAK MGMT PLANE</div>
                                <div id="peakCpuMgmt" style="font-size: 1.5em; font-weight: 700; color: #B8541E; font-family: var(--font-primary);">--</div>
                            </div>
                        </div>
                    </div>

                    <!-- Memory Chart -->
                    <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC;">
                        <h2 style="color: #333; margin: 0 0 20px 0; font-size: 1.4em; font-family: var(--font-primary);">Memory Usage History</h2>
                        <div style="position: relative; height: 300px;">
                            <canvas id="analyticsMemoryChart"></canvas>
                        </div>
                        <!-- Memory Stats -->
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px;">
                            <div style="text-align: center; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">AVG MEMORY</div>
                                <div id="avgMemory" style="font-size: 1.5em; font-weight: 700; color: #C23C14; font-family: var(--font-primary);">--</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">PEAK MEMORY</div>
                                <div id="peakMemory" style="font-size: 1.5em; font-weight: 700; color: #C23C14; font-family: var(--font-primary);">--</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sessions Breakdown Stacked Area Chart -->
                <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC; margin-bottom: 25px;">
                    <h2 style="color: #333; margin: 0 0 20px 0; font-size: 1.4em; font-family: var(--font-primary);">Session Protocol Breakdown</h2>
                    <div style="position: relative; height: 350px;">
                        <canvas id="analyticsSessionsChart"></canvas>
                    </div>

                    <!-- Sessions Stats -->
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 25px; padding-top: 20px; border-top: 2px solid #f0f0f0;">
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">PEAK TOTAL</div>
                            <div id="peakTotalSessions" style="font-size: 1.5em; font-weight: 700; color: #9C27B0; font-family: var(--font-primary);">--</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">PEAK TCP</div>
                            <div id="peakTcpSessions" style="font-size: 1.5em; font-weight: 700; color: #2196F3; font-family: var(--font-primary);">--</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">PEAK UDP</div>
                            <div id="peakUdpSessions" style="font-size: 1.5em; font-weight: 700; color: #4CAF50; font-family: var(--font-primary);">--</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">PEAK ICMP</div>
                            <div id="peakIcmpSessions" style="font-size: 1.5em; font-weight: 700; color: #FF9800; font-family: var(--font-primary);">--</div>
                        </div>
                    </div>
                </div>

                <!-- Threat Count Timeline Chart -->
                <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC; margin-bottom: 25px;">
                    <h2 style="color: #333; margin: 0 0 20px 0; font-size: 1.4em; font-family: var(--font-primary);">Threat Detection Timeline</h2>
                    <div style="position: relative; height: 300px;">
                        <canvas id="analyticsThreatsChart"></canvas>
                    </div>

                    <!-- Threat Stats -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 25px; padding-top: 20px; border-top: 2px solid #f0f0f0;">
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">TOTAL THREATS</div>
                            <div id="totalThreats" style="font-size: 1.5em; font-weight: 700; color: #D32F2F; font-family: var(--font-primary);">--</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">PEAK HOURLY</div>
                            <div id="peakHourlyThreats" style="font-size: 1.5em; font-weight: 700; color: #C62828; font-family: var(--font-primary);">--</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="color: #999; font-size: 0.85em; font-family: var(--font-primary);">AVG PER HOUR</div>
                            <div id="avgHourlyThreats" style="font-size: 1.5em; font-weight: 700; color: #B71C1C; font-family: var(--font-primary);">--</div>
                        </div>
                    </div>
                </div>

                <!-- Multi-Metric Comparison Dashboard (6 Mini-Charts) -->
                <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC; margin-bottom: 25px;">
                    <h2 style="color: #333; margin: 0 0 25px 0; font-size: 1.4em; font-family: var(--font-primary);">Metric Correlation Dashboard</h2>

                    <!-- Grid of 6 mini-charts (2 rows x 3 columns) -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">

                        <!-- Chart 1: Throughput vs Sessions -->
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 10px; padding: 20px; border: 2px solid #FA582D;">
                            <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; font-family: var(--font-primary); text-align: center;">Throughput vs Sessions</h3>
                            <div style="position: relative; height: 200px;">
                                <canvas id="comparisonChart1"></canvas>
                            </div>
                        </div>

                        <!-- Chart 2: CPU vs Memory -->
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 10px; padding: 20px; border: 2px solid #E04F26;">
                            <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; font-family: var(--font-primary); text-align: center;">CPU vs Memory</h3>
                            <div style="position: relative; height: 200px;">
                                <canvas id="comparisonChart2"></canvas>
                            </div>
                        </div>

                        <!-- Chart 3: TCP vs UDP Sessions -->
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 10px; padding: 20px; border: 2px solid #2196F3;">
                            <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; font-family: var(--font-primary); text-align: center;">TCP vs UDP Sessions</h3>
                            <div style="position: relative; height: 200px;">
                                <canvas id="comparisonChart3"></canvas>
                            </div>
                        </div>

                        <!-- Chart 4: Internal vs Internet Traffic -->
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 10px; padding: 20px; border: 2px solid #4CAF50;">
                            <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; font-family: var(--font-primary); text-align: center;">Internal vs Internet</h3>
                            <div style="position: relative; height: 200px;">
                                <canvas id="comparisonChart4"></canvas>
                            </div>
                        </div>

                        <!-- Chart 5: Threats vs Sessions -->
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 10px; padding: 20px; border: 2px solid #D32F2F;">
                            <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; font-family: var(--font-primary); text-align: center;">Threats vs Sessions</h3>
                            <div style="position: relative; height: 200px;">
                                <canvas id="comparisonChart5"></canvas>
                            </div>
                        </div>

                        <!-- Chart 6: Interface Errors vs Throughput -->
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 10px; padding: 20px; border: 2px solid #FF9800;">
                            <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; font-family: var(--font-primary); text-align: center;">Errors vs Throughput</h3>
                            <div style="position: relative; height: 200px;">
                                <canvas id="comparisonChart6"></canvas>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Top Bandwidth Clients Section -->
                <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC; margin-bottom: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="color: #333; margin: 0; font-size: 1.4em; font-family: var(--font-primary);">Top Bandwidth Clients</h2>
                        <div style="display: flex; gap: 10px;">
                            <select id="clientFilterType" onchange="loadTopClients()" style="padding: 8px 12px; border: 2px solid #FA582D; border-radius: 6px; font-family: var(--font-secondary); cursor: pointer;">
                                <option value="all">All Traffic</option>
                                <option value="internal">Internal Only</option>
                                <option value="internet">Internet Only</option>
                            </select>
                            <button onclick="refreshTopClients()" style="padding: 8px 16px; background: linear-gradient(135deg, #17a2b8 0%, #20c9e0 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">
                                🔄 Refresh
                            </button>
                        </div>
                    </div>
                    <div id="topClientsTable" style="overflow-x: auto;">
                        <div style="text-align: center; padding: 40px; color: #999; font-family: var(--font-secondary);">Loading top clients...</div>
                    </div>
                </div>

                <!-- Log Search Section -->
                <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC; margin-bottom: 25px;">
                    <h2 style="color: #333; margin: 0 0 20px 0; font-size: 1.4em; font-family: var(--font-primary);">Log Search</h2>
                    <div style="display: grid; grid-template-columns: 1fr auto auto; gap: 15px; margin-bottom: 20px;">
                        <input type="text" id="logSearchInput" placeholder="Search logs by keyword, IP, threat name..." style="padding: 12px 15px; border: 2px solid #ddd; border-radius: 6px; font-size: 1em; font-family: var(--font-secondary);" onkeyup="if(event.key === 'Enter') searchLogs()">
                        <select id="logSearchType" style="padding: 12px 15px; border: 2px solid #ddd; border-radius: 6px; font-family: var(--font-secondary);">
                            <option value="all">All Logs</option>
                            <option value="system">System Logs</option>
                            <option value="traffic">Traffic Logs</option>
                            <option value="threat">Threat Logs</option>
                        </select>
                        <button onclick="searchLogs()" style="padding: 12px 25px; background: linear-gradient(135deg, #E8491D 0%, #FA582D 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">
                            🔍 Search
                        </button>
                    </div>
                    <div id="logSearchResults" style="font-family: var(--font-secondary); max-height: 400px; overflow-y: auto;">
                        <div style="color: #999; text-align: center; padding: 40px;">Enter a search term and click Search to find logs</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Content -->
        <!-- Devices Content -->
        <div id="devices-content" class="page-content" style="display: none;">
            <div class="container">
                <div class="header" style="text-align: left; margin-bottom: 30px;">
                    <h1 style="color: #F2F0EF; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0;">Devices</h1>
                    <p style="color: #FA582D; font-size: 0.9em; margin: 0;">Manage Firewall Devices</p>
                </div>

                <div class="error-message" id="devicesErrorMessage"></div>

                <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-top: 4px solid #F7D9BC;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="color: #333; margin: 0;">Firewall Devices</h2>
                        <button id="addDeviceBtn" style="padding: 12px 24px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;">
                            + Add Device
                        </button>
                    </div>

                    <div id="devicesTableContainer">
                        <table id="devicesTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f5f5f5; border-bottom: 2px solid #FA582D;">
                                    <th onclick="sortDevices('name')" style="padding: 12px; text-align: left; color: #333; font-weight: 600; cursor: pointer; user-select: none;" title="Click to sort">
                                        Name <span id="sort-name"></span>
                                    </th>
                                    <th onclick="sortDevices('ip')" style="padding: 12px; text-align: left; color: #333; font-weight: 600; cursor: pointer; user-select: none;" title="Click to sort">
                                        IP Address <span id="sort-ip"></span>
                                    </th>
                                    <th onclick="sortDevices('group')" style="padding: 12px; text-align: left; color: #333; font-weight: 600; cursor: pointer; user-select: none;" title="Click to sort">
                                        Group <span id="sort-group"></span>
                                    </th>
                                    <th onclick="sortDevices('uptime')" style="padding: 12px; text-align: left; color: #333; font-weight: 600; cursor: pointer; user-select: none;" title="Click to sort">
                                        Uptime <span id="sort-uptime"></span>
                                    </th>
                                    <th onclick="sortDevices('version')" style="padding: 12px; text-align: left; color: #333; font-weight: 600; cursor: pointer; user-select: none;" title="Click to sort">
                                        PAN-OS Version <span id="sort-version"></span>
                                    </th>
                                    <th onclick="sortDevices('status')" style="padding: 12px; text-align: left; color: #333; font-weight: 600; cursor: pointer; user-select: none;" title="Click to sort">
                                        Status <span id="sort-status"></span>
                                    </th>
                                    <th style="padding: 12px; text-align: center; color: #333; font-weight: 600;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="devicesTableBody">
                                <tr>
                                    <td colspan="7" style="padding: 40px; text-align: center; color: #999;">
                                        Loading devices...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Device Add/Edit Modal -->
        <div id="deviceModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
            <div style="background: white; border-radius: 12px; padding: 30px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 id="deviceModalTitle" style="color: #333; margin: 0;">Add Device</h2>
                    <button id="closeModalBtn" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #999;">&times;</button>
                </div>

                <form id="deviceForm">
                    <input type="hidden" id="deviceId" value="">

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">Device Name *</label>
                        <input type="text" id="deviceName" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">IP Address *</label>
                        <input type="text" id="deviceIp" required placeholder="192.168.1.1" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">API Key *</label>
                        <input type="password" id="deviceApiKey" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; font-family: monospace;">
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">Group</label>
                        <select id="deviceGroup" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                            <option value="Default">Default</option>
                        </select>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">Description</label>
                        <textarea id="deviceDescription" rows="3" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; resize: vertical;"></textarea>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">WAN Interface</label>
                        <input type="text" id="deviceWanInterface" placeholder="ethernet1/1" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <p style="color: #666; font-size: 0.85em; margin: 5px 0 0 0;">Interface name to monitor for WAN IP (e.g., ethernet1/1)</p>
                    </div>

                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <button type="button" id="testConnectionBtn" style="flex: 1; padding: 12px; background: #666; color: #F2F0EF; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer;">
                            Test Connection
                        </button>
                    </div>

                    <div id="connectionTestResult" style="display: none; padding: 12px; border-radius: 8px; margin-bottom: 20px;"></div>

                    <div style="display: flex; gap: 15px;">
                        <button type="submit" style="flex: 1; padding: 15px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 8px; font-size: 1.1em; font-weight: 600; cursor: pointer;">
                            Save Device
                        </button>
                        <button type="button" id="cancelModalBtn" style="flex: 1; padding: 15px; background: #666; color: #F2F0EF; border: none; border-radius: 8px; font-size: 1.1em; font-weight: 600; cursor: pointer;">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="settings-content" class="page-content" style="display: none;">
            <div class="container">
                <div class="header" style="text-align: left; margin-bottom: 30px;">
                    <h1 style="color: #F2F0EF; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0;">Settings</h1>
                    <p style="color: #FA582D; font-size: 0.9em; margin: 0;">Configure Dashboard Parameters</p>
                </div>

                <div class="error-message" id="settingsErrorMessage"></div>

                <!-- Settings Tabs -->
                <div style="background: white; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); overflow: hidden;">
                    <!-- Tab Headers -->
                    <div style="display: flex; background: #f5f5f5; border-bottom: 2px solid #FA582D;">
                        <div class="settings-tab active" data-tab="general" style="flex: 1; padding: 15px 20px; text-align: center; cursor: pointer; font-weight: 600; color: #333; border-bottom: 3px solid #FA582D; background: white; transition: all 0.3s;">
                            General
                        </div>
                        <div class="settings-tab" data-tab="security" style="flex: 1; padding: 15px 20px; text-align: center; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s;">
                            Security
                        </div>
                        <div class="settings-tab" data-tab="backup" style="flex: 1; padding: 15px 20px; text-align: center; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s;">
                            Backup & Restore
                        </div>
                        <div class="settings-tab" data-tab="databases" style="flex: 1; padding: 15px 20px; text-align: center; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s;">
                            Databases
                        </div>
                        <div class="settings-tab" data-tab="services" style="flex: 1; padding: 15px 20px; text-align: center; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s;">
                            Services
                        </div>
                        <div class="settings-tab" data-tab="integrations" style="flex: 1; padding: 15px 20px; text-align: center; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s;">
                            Integrations
                        </div>
                        <div class="settings-tab" data-tab="debug" style="flex: 1; padding: 15px 20px; text-align: center; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s;">
                            Debug
                        </div>
                    </div>

                    <!-- Tab Content -->
                    <div style="padding: 30px; max-width: 800px;">
                        <!-- General Tab -->
                        <div id="general-tab" class="settings-tab-content">
                            <h2 style="color: #333; margin-bottom: 20px; font-size: 1.3em;">General Settings</h2>

                            <div style="margin-bottom: 30px;">
                                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 10px; font-size: 1.1em;">
                                    Refresh Interval (seconds)
                                </label>
                                <input type="number" id="refreshInterval" min="30" max="300" value="60"
                                       style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; transition: border-color 0.3s;">
                                <p style="color: #666; font-size: 0.9em; margin-top: 5px;">How often to update the dashboard data (30-300 seconds = 30s to 5 minutes)</p>
                            </div>

                            <div style="margin-bottom: 30px;">
                                <label style="display: flex; align-items: center; cursor: pointer; user-select: none;">
                                    <input type="checkbox" id="tonyMode" style="width: 20px; height: 20px; cursor: pointer; margin-right: 10px; accent-color: #FA582D;">
                                    <span style="color: #333; font-weight: 600; font-size: 1.1em;">Tony Mode</span>
                                </label>
                                <p style="color: #666; font-size: 0.9em; margin-top: 5px; margin-left: 30px;">Disable session timeout (stay logged in indefinitely)</p>
                            </div>

                            <div style="margin-bottom: 30px;">
                                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 10px; font-size: 1.1em;">
                                    Timezone
                                </label>
                                <select id="timezone" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; transition: border-color 0.3s; background: white; cursor: pointer;">
                                    <option value="UTC">UTC (Coordinated Universal Time)</option>
                                    <option value="America/New_York">Eastern Time (ET)</option>
                                    <option value="America/Chicago">Central Time (CT)</option>
                                    <option value="America/Denver">Mountain Time (MT)</option>
                                    <option value="America/Los_Angeles">Pacific Time (PT)</option>
                                    <option value="America/Anchorage">Alaska Time (AKT)</option>
                                    <option value="Pacific/Honolulu">Hawaii Time (HT)</option>
                                    <option value="Europe/London">London (GMT/BST)</option>
                                    <option value="Europe/Paris">Paris (CET/CEST)</option>
                                    <option value="Europe/Berlin">Berlin (CET/CEST)</option>
                                    <option value="Europe/Moscow">Moscow (MSK)</option>
                                    <option value="Asia/Dubai">Dubai (GST)</option>
                                    <option value="Asia/Kolkata">India (IST)</option>
                                    <option value="Asia/Shanghai">China (CST)</option>
                                    <option value="Asia/Tokyo">Tokyo (JST)</option>
                                    <option value="Asia/Singapore">Singapore (SGT)</option>
                                    <option value="Australia/Sydney">Sydney (AEDT/AEST)</option>
                                    <option value="Pacific/Auckland">Auckland (NZDT/NZST)</option>
                                </select>
                                <p style="color: #666; font-size: 0.9em; margin-top: 5px;">Timezone for displaying all dates and times</p>
                            </div>

                        </div>

                        <!-- Security Tab -->
                        <div id="security-tab" class="settings-tab-content" style="display: none;">
                            <h2 style="color: #333; margin-bottom: 20px; font-size: 1.3em;">Security Settings</h2>

                            <!-- Password Change Warning (shown when must change) -->
                            <div id="passwordChangeWarning" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 20px; border-radius: 4px; display: none;">
                                <strong style="color: #856404;">⚠️ Password Change Required</strong>
                                <p style="color: #856404; margin: 5px 0 0 0; font-size: 0.9em;">You are using the default password. Please change it now for security.</p>
                            </div>

                            <!-- Change Password Section -->
                            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 25px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.3em;">🔐</span>
                                    Change Password
                                </h3>

                                <p style="color: #666; margin: 0 0 20px 0; font-size: 0.95em;">
                                    Update your login password. Passwords are securely hashed with bcrypt and encrypted at rest.
                                </p>

                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">Current Password</label>
                                    <input type="password"
                                           id="currentPassword"
                                           placeholder="Enter your current password"
                                           style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; transition: border-color 0.3s;"
                                           onfocus="this.style.borderColor='#FA582D'"
                                           onblur="this.style.borderColor='#ddd'">
                                </div>

                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">New Password</label>
                                    <input type="password"
                                           id="newPassword"
                                           placeholder="Enter your new password (min 8 characters)"
                                           style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; transition: border-color 0.3s;"
                                           onfocus="this.style.borderColor='#FA582D'"
                                           onblur="this.style.borderColor='#ddd'">
                                    <p style="color: #666; font-size: 0.85em; margin-top: 5px;">Minimum 8 characters required</p>
                                </div>

                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">Confirm New Password</label>
                                    <input type="password"
                                           id="confirmPassword"
                                           placeholder="Re-enter your new password"
                                           style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; transition: border-color 0.3s;"
                                           onfocus="this.style.borderColor='#FA582D'"
                                           onblur="this.style.borderColor='#ddd'">
                                </div>

                                <button id="changePasswordBtn"
                                        style="width: 100%; padding: 15px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 8px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;"
                                        onmouseover="this.style.transform='scale(1.02)'"
                                        onmouseout="this.style.transform='scale(1)'">
                                    Change Password
                                </button>

                                <div id="passwordChangeMessage" style="display: none; margin-top: 15px; padding: 12px; border-radius: 6px;"></div>
                            </div>

                            <!-- Security Information -->
                            <div style="background: #e7f3ff; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
                                <strong style="color: #0c5460;">🛡️ Security Features</strong>
                                <ul style="color: #0c5460; margin: 10px 0 0 20px; font-size: 0.9em;">
                                    <li>Passwords are hashed using bcrypt (cost factor: 12)</li>
                                    <li>Credentials are encrypted at rest in auth.json</li>
                                    <li>Session timeout: 24 hours</li>
                                    <li>Rate limiting: 3 password changes per hour</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Backup & Restore Tab -->
                        <div id="backup-tab" class="settings-tab-content" style="display: none;">
                            <h2 style="color: #333; margin-bottom: 20px; font-size: 1.3em;">Backup & Restore</h2>

                            <!-- Backup Section -->
                            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 25px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.3em;">💾</span>
                                    Create Backup
                                </h3>

                                <p style="color: #666; margin: 0 0 10px 0; font-size: 0.95em;">
                                    Create a comprehensive backup of your Settings, Devices, and Device Metadata. The backup file will be downloaded to your computer.
                                </p>

                                <p style="color: #999; margin: 0 0 20px 0; font-size: 0.85em; font-style: italic;">
                                    Note: Optional databases (MAC Vendor DB, Service Port DB) are not included in backups. They can be re-uploaded via the Databases tab if needed.
                                </p>

                                <button id="createBackupBtn"
                                        style="width: 100%; padding: 15px; background: linear-gradient(135deg, #28a745 0%, #34ce57 100%); color: #F2F0EF; border: none; border-radius: 8px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;"
                                        onmouseover="this.style.transform='scale(1.02)'"
                                        onmouseout="this.style.transform='scale(1)'">
                                    📥 Create & Download Backup
                                </button>

                                <div id="backupMessage" style="display: none; margin-top: 15px; padding: 12px; border-radius: 6px;"></div>
                            </div>

                            <!-- Restore Section -->
                            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 25px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.3em;">📤</span>
                                    Restore from Backup
                                </h3>

                                <p style="color: #666; margin: 0 0 20px 0; font-size: 0.95em;">
                                    Restore your configuration from a previously created backup file. You can choose which components to restore.
                                </p>

                                <!-- File Upload -->
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">Select Backup File</label>
                                    <input type="file"
                                           id="backupFileInput"
                                           accept=".json"
                                           style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; transition: border-color 0.3s;"
                                           onfocus="this.style.borderColor='#FA582D'"
                                           onblur="this.style.borderColor='#ddd'">
                                </div>

                                <!-- Backup Info (shown after file selected) -->
                                <div id="backupInfo" style="display: none; background: #e7f3ff; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
                                    <strong style="color: #0c5460;">📋 Backup Information</strong>
                                    <ul style="color: #0c5460; margin: 10px 0 0 20px; font-size: 0.9em;" id="backupInfoList"></ul>
                                </div>

                                <!-- Selective Restore Checkboxes -->
                                <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 15px; margin-bottom: 20px;">
                                    <strong style="color: #333; display: block; margin-bottom: 10px;">Components to Restore:</strong>

                                    <label style="display: block; margin-bottom: 10px; cursor: pointer;">
                                        <input type="checkbox" id="restoreSettings" checked style="margin-right: 8px;">
                                        <span style="color: #333; font-weight: 500;">Settings</span>
                                        <span style="color: #666; font-size: 0.85em; margin-left: 5px;">(refresh intervals, monitored interface)</span>
                                    </label>

                                    <label style="display: block; margin-bottom: 10px; cursor: pointer;">
                                        <input type="checkbox" id="restoreDevices" checked style="margin-right: 8px;">
                                        <span style="color: #333; font-weight: 500;">Devices</span>
                                        <span style="color: #666; font-size: 0.85em; margin-left: 5px;">(firewall configurations and credentials)</span>
                                    </label>

                                    <label style="display: block; cursor: pointer;">
                                        <input type="checkbox" id="restoreMetadata" checked style="margin-right: 8px;">
                                        <span style="color: #333; font-weight: 500;">Device Metadata</span>
                                        <span style="color: #666; font-size: 0.85em; margin-left: 5px;">(custom names, tags, locations)</span>
                                    </label>
                                </div>

                                <button id="restoreBackupBtn"
                                        style="width: 100%; padding: 15px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 8px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; opacity: 0.5;"
                                        onmouseover="if(!this.disabled) this.style.transform='scale(1.02)'"
                                        onmouseout="this.style.transform='scale(1)'"
                                        disabled>
                                    🔄 Restore from Backup
                                </button>

                                <div id="restoreMessage" style="display: none; margin-top: 15px; padding: 12px; border-radius: 6px;"></div>
                            </div>

                            <!-- Migration Section -->
                            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 25px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.3em;">🔄</span>
                                    Metadata Migration
                                </h3>

                                <p style="color: #666; margin: 0 0 15px 0; font-size: 0.95em;">
                                    Migrate device metadata from global format (v1.5.x) to per-device format (v1.6.0+).
                                </p>

                                <div id="migrationStatus" style="margin-bottom: 15px;">
                                    <strong style="color: #333;">Status: </strong><span id="migrationStatusText" style="color: #666;">Checking...</span>
                                </div>

                                <button id="checkMigrationBtn"
                                        style="width: 48%; padding: 12px; margin-right: 4%; background: #6c757d; color: #F2F0EF; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: transform 0.2s;"
                                        onmouseover="this.style.transform='scale(1.02)'"
                                        onmouseout="this.style.transform='scale(1)'">
                                    🔍 Check Status
                                </button>

                                <button id="migrateBtnSettings"
                                        style="width: 48%; padding: 12px; background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); color: #F2F0EF; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: transform 0.2s; opacity: 0.5;"
                                        onmouseover="if(!this.disabled) this.style.transform='scale(1.02)'"
                                        onmouseout="this.style.transform='scale(1)'"
                                        disabled>
                                    ⚡ Migrate Now
                                </button>

                                <div id="migrationMessage" style="display: none; margin-top: 15px; padding: 12px; border-radius: 6px;"></div>
                            </div>

                            <!-- Warning Notice -->
                            <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; border-radius: 4px;">
                                <strong style="color: #856404;">⚠️ Important Notes</strong>
                                <ul style="color: #856404; margin: 10px 0 0 20px; font-size: 0.9em;">
                                    <li>Backup files contain encrypted data and are safe to download</li>
                                    <li>Restoring will <strong>overwrite</strong> your current configuration for selected components</li>
                                    <li>Create a backup before restoring from an older backup</li>
                                    <li>Migration is a one-time operation (cannot be undone)</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Debug Tab -->
                        <div id="debug-tab" class="settings-tab-content" style="display: none;">
                            <h2 style="color: #333; margin-bottom: 20px; font-size: 1.3em;">Debug Settings</h2>

                            <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
                                <strong style="color: #856404;">⚠️ Performance Notice</strong>
                                <p style="color: #856404; margin: 5px 0 0 0; font-size: 0.9em;">Debug logging may impact performance. Enable only when troubleshooting issues.</p>
                            </div>

                            <div style="margin-bottom: 30px;">
                                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 10px; font-size: 1.1em;">
                                    <input type="checkbox" id="debugLogging" style="margin-right: 10px; width: 18px; height: 18px; vertical-align: middle; cursor: pointer;">
                                    Enable Debug Logging
                                </label>
                                <p style="color: #666; font-size: 0.9em; margin-top: 5px;">Log detailed API responses and debugging information to debug.log file</p>
                            </div>

                            <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em;">Log File Information</h3>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div>
                                        <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Log File Location</div>
                                        <div style="color: #333; font-weight: 600; font-family: monospace; font-size: 0.9em;">debug.log</div>
                                    </div>
                                    <div>
                                        <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Max File Size</div>
                                        <div style="color: #333; font-weight: 600;">10 MB</div>
                                    </div>
                                    <div>
                                        <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Backup Files</div>
                                        <div style="color: #333; font-weight: 600;">5 rotations</div>
                                    </div>
                                    <div>
                                        <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Total Storage</div>
                                        <div style="color: #333; font-weight: 600;">~60 MB max</div>
                                    </div>
                                </div>
                            </div>

                            <div style="background: #e7f3ff; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px;">
                                <strong style="color: #0c5460;">💡 Viewing Logs</strong>
                                <p style="color: #0c5460; margin: 5px 0 0 0; font-size: 0.9em;">Use <code style="background: #fff; padding: 2px 6px; border-radius: 3px;">tail -f debug.log</code> to view logs in real-time</p>
                            </div>
                        </div>

                        <!-- Databases Tab -->
                        <div id="databases-tab" class="settings-tab-content" style="display: none;">
                            <h2 style="color: #333; margin-bottom: 20px; font-size: 1.3em;">Database Settings</h2>

                            <!-- MAC Vendor Database -->
                            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 25px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.3em;">🏷️</span>
                                    MAC Vendor Database
                                </h3>

                                <p style="color: #666; margin: 0 0 15px 0; font-size: 0.95em;">
                                    Upload a MAC vendor database to display manufacturer names alongside MAC addresses in the Connected Devices page.
                                </p>

                                <div id="vendorDbInfo" style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 15px; margin-bottom: 15px;">
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                        <div>
                                            <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Status</div>
                                            <div id="vendorDbStatus" style="color: #333; font-weight: 600;">Loading...</div>
                                        </div>
                                        <div>
                                            <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Entries</div>
                                            <div id="vendorDbEntries" style="color: #333; font-weight: 600;">-</div>
                                        </div>
                                        <div>
                                            <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">File Size</div>
                                            <div id="vendorDbSize" style="color: #333; font-weight: 600;">-</div>
                                        </div>
                                        <div>
                                            <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Last Updated</div>
                                            <div id="vendorDbModified" style="color: #333; font-weight: 600;">-</div>
                                        </div>
                                    </div>
                                </div>

                                <div style="background: #e7f3ff; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px; margin-bottom: 15px;">
                                    <strong style="color: #0c5460;">📥 Database Source</strong>
                                    <p style="color: #0c5460; margin: 10px 0 5px 0; font-size: 0.9em;">Download the latest MAC vendor database from:</p>
                                    <a href="https://maclookup.app/downloads/json-database" target="_blank" style="color: #2196f3; font-family: monospace; font-size: 0.85em; word-break: break-all;">https://maclookup.app/downloads/json-database</a>
                                </div>

                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">Upload Database File (JSON)</label>
                                    <input type="file"
                                           id="vendorDbFileInput"
                                           accept=".json"
                                           style="display: block; width: 100%; padding: 10px; border: 2px dashed #ddd; border-radius: 6px; background: #f8f9fa; cursor: pointer;"
                                    />
                                    <div style="color: #666; font-size: 0.85em; margin-top: 5px;">Select a JSON file containing MAC vendor data</div>
                                </div>

                                <div style="display: flex; gap: 10px;">
                                    <button id="uploadVendorDbBtn"
                                            style="flex: 1; padding: 12px 20px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: transform 0.2s;"
                                            onmouseover="this.style.transform='scale(1.02)'"
                                            onmouseout="this.style.transform='scale(1)'">
                                        Upload Database
                                    </button>
                                    <button id="refreshVendorDbInfoBtn"
                                            style="padding: 12px 20px; background: #6c757d; color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: transform 0.2s;"
                                            onmouseover="this.style.transform='scale(1.02)'"
                                            onmouseout="this.style.transform='scale(1)'">
                                        Refresh Info
                                    </button>
                                </div>

                                <div id="vendorDbUploadMessage" style="display: none; margin-top: 15px; padding: 12px; border-radius: 6px;"></div>
                            </div>

                            <!-- Service Port Database -->
                            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 25px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.3em;">🔌</span>
                                    Service Port Database
                                </h3>

                                <p style="color: #666; margin: 0 0 15px 0; font-size: 0.95em;">
                                    Upload the IANA service port database to display service names alongside port numbers in the Applications page.
                                </p>

                                <div id="servicePortDbInfo" style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 15px; margin-bottom: 15px;">
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                        <div>
                                            <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Status</div>
                                            <div id="servicePortDbStatus" style="color: #333; font-weight: 600;">Loading...</div>
                                        </div>
                                        <div>
                                            <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Port Entries</div>
                                            <div id="servicePortDbEntries" style="color: #333; font-weight: 600;">-</div>
                                        </div>
                                        <div>
                                            <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">File Size</div>
                                            <div id="servicePortDbSize" style="color: #333; font-weight: 600;">-</div>
                                        </div>
                                        <div>
                                            <div style="color: #666; font-size: 0.85em; margin-bottom: 5px;">Last Updated</div>
                                            <div id="servicePortDbModified" style="color: #333; font-weight: 600;">-</div>
                                        </div>
                                    </div>
                                </div>

                                <div style="background: #e7f3ff; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px; margin-bottom: 15px;">
                                    <strong style="color: #0c5460;">📥 Database Source</strong>
                                    <p style="color: #0c5460; margin: 10px 0 5px 0; font-size: 0.9em;">Download the IANA service names and port numbers registry:</p>
                                    <a href="https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xml" target="_blank" style="color: #2196f3; font-family: monospace; font-size: 0.85em; word-break: break-all;">https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xml</a>
                                </div>

                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px;">Upload Database File (XML)</label>
                                    <input type="file"
                                           id="servicePortDbFileInput"
                                           accept=".xml"
                                           style="display: block; width: 100%; padding: 10px; border: 2px dashed #ddd; border-radius: 6px; background: #f8f9fa; cursor: pointer;"
                                    />
                                    <div style="color: #666; font-size: 0.85em; margin-top: 5px;">Select the IANA service-names-port-numbers.xml file</div>
                                </div>

                                <div style="display: flex; gap: 10px;">
                                    <button id="uploadServicePortDbBtn"
                                            style="flex: 1; padding: 12px 20px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: transform 0.2s;"
                                            onmouseover="this.style.transform='scale(1.02)'"
                                            onmouseout="this.style.transform='scale(1)'">
                                        Upload Database
                                    </button>
                                    <button id="refreshServicePortDbInfoBtn"
                                            style="padding: 12px 20px; background: #6c757d; color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: transform 0.2s;"
                                            onmouseover="this.style.transform='scale(1.02)'"
                                            onmouseout="this.style.transform='scale(1)'">
                                        Refresh Info
                                    </button>
                                </div>

                                <div id="servicePortDbUploadMessage" style="display: none; margin-top: 15px; padding: 12px; border-radius: 6px;"></div>
                            </div>

                            <!-- Device Metadata Backup -->
                            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 25px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.3em;">💾</span>
                                    Device Metadata Backup
                                </h3>

                                <p style="color: #666; margin: 0 0 15px 0; font-size: 0.95em;">
                                    Export your device metadata (custom names, locations, comments, and tags) as a JSON backup file, or import a previously exported backup to restore your metadata.
                                </p>

                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <button id="exportMetadataBtn" style="padding: 10px 20px; background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                        📥 Export Metadata
                                    </button>
                                    <label for="importMetadataFile" style="padding: 10px 20px; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; transition: transform 0.2s; display: inline-block;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                        📤 Import Metadata
                                        <input type="file" id="importMetadataFile" accept=".json" style="display: none;" onchange="importDeviceMetadata()">
                                    </label>
                                </div>

                                <div style="background: #e7f3ff; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px; margin-top: 15px;">
                                    <strong style="color: #0c5460;">ℹ️ Backup Information</strong>
                                    <p style="color: #0c5460; margin: 10px 0 0 0; font-size: 0.9em;">
                                        Exported files include all custom device names, locations, comments, and tags. Importing will merge the backup with existing metadata (imported data takes precedence for conflicts).
                                    </p>
                                </div>
                            </div>

                            <!-- Other Database Settings -->
                            <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 30px; text-align: center;">
                                <div style="font-size: 3em; margin-bottom: 15px; opacity: 0.3;">🗄️</div>
                                <h3 style="color: #666; margin: 0 0 10px 0; font-weight: 600;">Additional Database Configuration</h3>
                                <p style="color: #999; margin: 0;">Additional database integration settings will be available in a future release.</p>
                                <p style="color: #999; margin: 10px 0 0 0; font-size: 0.9em;">Currently, all data is stored in JSON files (settings.json, devices.json)</p>
                            </div>
                        </div>

                        <!-- Services Tab -->
                        <div id="services-tab" class="settings-tab-content" style="display: none;">
                            <h2 style="color: #333; margin-bottom: 20px; font-size: 1.3em;">System Services Status</h2>

                            <!-- Service Status Cards -->
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                                <!-- APScheduler Card -->
                                <div style="background: white; border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                        <span style="font-size: 2em; margin-right: 10px;">⏱️</span>
                                        <h3 style="color: #FA582D; margin: 0; font-size: 1.1em;">Clock Process (APScheduler)</h3>
                                    </div>
                                    <div id="scheduler-status" style="margin-bottom: 10px;">
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>Status:</strong> <span id="scheduler-state" style="color: #10b981; font-weight: 600;">Loading...</span>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>Uptime:</strong> <span id="scheduler-uptime">--</span>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>Total Executions:</strong> <span id="scheduler-executions">--</span>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>Total Errors:</strong> <span id="scheduler-errors">--</span>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>Last Execution:</strong> <span id="scheduler-last-execution">--</span>
                                        </div>
                                        <div id="scheduler-error-details" style="display: none; margin-top: 10px; padding: 8px; background: #fee; border-left: 3px solid #ef4444; border-radius: 4px;">
                                            <div style="font-size: 0.85em; color: #ef4444; font-weight: 600; margin-bottom: 3px;">Last Error:</div>
                                            <div id="scheduler-last-error" style="font-size: 0.8em; color: #666; word-break: break-word;"></div>
                                            <div id="scheduler-last-error-time" style="font-size: 0.75em; color: #999; margin-top: 3px;"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Database Card -->
                                <div style="background: white; border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                        <span style="font-size: 2em; margin-right: 10px;">💾</span>
                                        <h3 style="color: #FA582D; margin: 0; font-size: 1.1em;">Database</h3>
                                    </div>
                                    <div id="database-status" style="margin-bottom: 10px;">
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>Status:</strong> <span id="database-state" style="color: #10b981; font-weight: 600;">Loading...</span>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>Size:</strong> <span id="database-size">--</span>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>Total Samples:</strong> <span id="database-samples">--</span>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666;">
                                            <strong>Oldest Sample:</strong> <span id="database-oldest">--</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Detailed Job Information -->
                            <div style="background: white; border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1em;">Scheduled Jobs</h3>
                                <div id="jobs-list" style="font-size: 0.9em; color: #666;">
                                    <div style="text-align: center; padding: 20px; color: #999;">Loading job information...</div>
                                </div>
                            </div>

                            <!-- Database Per-Device Information -->
                            <div style="background: white; border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                                <h3 style="color: #333; margin: 0 0 15px 0; font-size: 1em;">Database Statistics by Device</h3>
                                <div id="device-stats" style="font-size: 0.9em; color: #666;">
                                    <div style="text-align: center; padding: 20px; color: #999;">Loading device statistics...</div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div style="margin-top: 20px; display: flex; justify-content: space-between; align-items: center;">
                                <button onclick="clearDatabase()" style="padding: 10px 20px; background: #dc2626; color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.9em; font-weight: 600; cursor: pointer; font-family: var(--font-primary); transition: transform 0.2s;">
                                    🗑️ Clear Database
                                </button>
                                <button onclick="refreshServicesStatus()" style="padding: 10px 20px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.9em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">
                                    🔄 Refresh Status
                                </button>
                            </div>
                        </div>

                        <!-- Integrations Tab -->
                        <div id="integrations-tab" class="settings-tab-content" style="display: none;">
                            <h2 style="color: #333; margin-bottom: 20px; font-size: 1.3em; font-family: var(--font-primary);">Alert Notification Channels</h2>
                            <p style="color: #666; margin-bottom: 30px;">Configure how alert notifications are delivered. Test each channel after configuration.</p>

                            <!-- Email Notifications -->
                            <div style="background: white; border: 2px solid #FA582D; border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #FA582D;">
                                    <h3 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.2em;">📧 Email (SMTP)</h3>
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <span style="margin-right: 10px; color: #666; font-weight: 600;">Enabled</span>
                                        <input type="checkbox" id="emailEnabled" style="width: 20px; height: 20px; cursor: pointer; accent-color: #FA582D;">
                                    </label>
                                </div>

                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">SMTP Host</label>
                                        <input type="text" id="emailSmtpHost" placeholder="smtp.gmail.com" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                    </div>
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">SMTP Port</label>
                                        <input type="number" id="emailSmtpPort" value="587" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                    </div>
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">SMTP Username</label>
                                        <input type="text" id="emailSmtpUser" placeholder="your-email@example.com" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                    </div>
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">SMTP Password</label>
                                        <input type="password" id="emailSmtpPassword" placeholder="••••••••" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                    </div>
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">From Email</label>
                                        <input type="email" id="emailFromEmail" placeholder="alerts@example.com" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                    </div>
                                    <div>
                                        <label style="display: flex; align-items: center; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">
                                            <input type="checkbox" id="emailUseTls" checked style="width: 18px; height: 18px; margin-right: 8px; cursor: pointer; accent-color: #FA582D;">
                                            Use TLS/STARTTLS
                                        </label>
                                        <p style="color: #999; font-size: 0.85em; margin: 0;">Recommended for security</p>
                                    </div>
                                </div>
                                <div style="margin-top: 15px;">
                                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">To Emails (comma-separated)</label>
                                    <input type="text" id="emailToEmails" placeholder="admin1@example.com, admin2@example.com" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                </div>
                                <div style="margin-top: 20px; display: flex; gap: 10px;">
                                    <button onclick="saveNotificationChannel('email')" style="flex: 1; padding: 12px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Save Email Settings</button>
                                    <button onclick="testNotificationChannel('email')" style="padding: 12px 20px; background: #28a745; color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Test Email</button>
                                </div>
                            </div>

                            <!-- Slack Notifications -->
                            <div style="background: white; border: 2px solid #FA582D; border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #FA582D;">
                                    <h3 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.2em;">💬 Slack</h3>
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <span style="margin-right: 10px; color: #666; font-weight: 600;">Enabled</span>
                                        <input type="checkbox" id="slackEnabled" style="width: 20px; height: 20px; cursor: pointer; accent-color: #FA582D;">
                                    </label>
                                </div>

                                <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">Webhook URL</label>
                                        <input type="text" id="slackWebhookUrl" placeholder="https://hooks.slack.com/services/YOUR/WEBHOOK/URL" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                        <p style="color: #999; font-size: 0.85em; margin: 5px 0 0 0;">Create a webhook at: <a href="https://api.slack.com/messaging/webhooks" target="_blank" style="color: #FA582D;">Slack Incoming Webhooks</a></p>
                                    </div>
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">Channel</label>
                                        <input type="text" id="slackChannel" placeholder="#alerts" value="#alerts" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                    </div>
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">Bot Username</label>
                                        <input type="text" id="slackUsername" placeholder="PANfm Alerts" value="PANfm Alerts" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                    </div>
                                </div>
                                <div style="margin-top: 20px; display: flex; gap: 10px;">
                                    <button onclick="saveNotificationChannel('slack')" style="flex: 1; padding: 12px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Save Slack Settings</button>
                                    <button onclick="testNotificationChannel('slack')" style="padding: 12px 20px; background: #28a745; color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Test Slack</button>
                                </div>
                            </div>

                            <!-- Generic Webhook Notifications -->
                            <div style="background: white; border: 2px solid #FA582D; border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #FA582D;">
                                    <h3 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.2em;">🔗 Generic Webhook</h3>
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <span style="margin-right: 10px; color: #666; font-weight: 600;">Enabled</span>
                                        <input type="checkbox" id="webhookEnabled" style="width: 20px; height: 20px; cursor: pointer; accent-color: #FA582D;">
                                    </label>
                                </div>

                                <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">Webhook URL</label>
                                        <input type="text" id="webhookUrl" placeholder="https://your-webhook-endpoint.com/alerts" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em;">
                                        <p style="color: #999; font-size: 0.85em; margin: 5px 0 0 0;">Sends JSON POST requests with alert data</p>
                                    </div>
                                    <div>
                                        <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-secondary);">Custom Headers (JSON format, optional)</label>
                                        <textarea id="webhookHeaders" placeholder='{"Authorization": "Bearer YOUR_TOKEN", "X-Custom-Header": "value"}' style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.95em; font-family: monospace; min-height: 80px;"></textarea>
                                    </div>
                                </div>
                                <div style="margin-top: 20px; display: flex; gap: 10px;">
                                    <button onclick="saveNotificationChannel('webhook')" style="flex: 1; padding: 12px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Save Webhook Settings</button>
                                    <button onclick="testNotificationChannel('webhook')" style="padding: 12px 20px; background: #28a745; color: #F2F0EF; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Test Webhook</button>
                                </div>
                            </div>

                            <!-- Info Box -->
                            <div style="background: #e8f4fd; border-left: 4px solid #0066cc; padding: 15px; border-radius: 6px;">
                                <p style="color: #004080; margin: 0; font-size: 0.95em; line-height: 1.6; font-family: var(--font-secondary);">
                                    <strong>ℹ️ How to use:</strong> Enable one or more notification channels, configure the settings, and click "Save" for each channel.
                                    Use the "Test" button to verify your configuration before creating alerts.
                                    Notification channels are selected per alert in the Alerts page.
                                </p>
                            </div>
                        </div>


                        </div>

                        <!-- Save Buttons (shared across all tabs) -->
                        <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd;">
                            <div style="display: flex; gap: 15px;">
                                <button id="saveSettings"
                                        style="flex: 1; padding: 15px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 8px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;">
                                    Save Settings
                                </button>
                                <button id="resetSettings"
                                        style="flex: 1; padding: 15px; background: #666; color: #F2F0EF; border: none; border-radius: 8px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;">
                                    Reset to Defaults
                                </button>
                            </div>

                            <div id="settingsSuccessMessage" style="display: none; margin-top: 20px; padding: 15px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px; color: #155724;">
                                Settings saved successfully!
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PAN-OS Upgrade Progress Modal -->
    <div id="upgradeModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 10000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 12px; padding: 30px; max-width: 600px; width: 90%; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);">
            <h2 id="upgradeModalTitle" style="color: #333; font-family: var(--font-primary); margin: 0 0 20px 0;">PAN-OS Upgrade in Progress</h2>

            <div style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <span style="font-weight: 600; color: #FA582D; font-family: var(--font-primary); font-size: 1.1em;" id="upgradeStep">Initializing...</span>
                    <span style="color: #666; font-family: var(--font-secondary); font-size: 0.9em;" id="upgradeProgress">0%</span>
                </div>

                <!-- Progress Bar -->
                <div style="width: 100%; height: 30px; background: #f0f0f0; border-radius: 15px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);">
                    <div id="upgradeProgressBar" style="height: 100%; width: 0%; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); transition: width 0.5s ease; display: flex; align-items: center; justify-content: center; color: #F2F0EF; font-weight: 600; font-size: 0.9em;"></div>
                </div>
            </div>

            <div style="padding: 15px; background: #f9f9f9; border-radius: 8px; margin-bottom: 20px;">
                <p id="upgradeMessage" style="margin: 0; color: #666; font-family: var(--font-secondary); font-size: 0.95em;">Starting upgrade process...</p>
            </div>

            <div style="padding: 15px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; margin-bottom: 20px;">
                <p style="margin: 0; color: #856404; font-family: var(--font-secondary); font-size: 0.9em;">
                    <strong>Warning:</strong> Do not close this window or navigate away during the upgrade process.
                </p>
            </div>

            <button id="cancelUpgradeBtn" onclick="cancelUpgrade()" style="padding: 10px 20px; background: #6c757d; color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-family: var(--font-primary);">
                Cancel
            </button>
        </div>
    </div>

    <!-- Content Update Progress Modal -->
    <div id="contentUpdateModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 10000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 12px; padding: 30px; max-width: 600px; width: 90%; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);">
            <h2 style="color: #333; font-family: var(--font-primary); margin: 0 0 20px 0;">Content Update in Progress</h2>

            <div style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <span style="font-weight: 600; color: #FA582D; font-family: var(--font-primary); font-size: 1.1em;" id="contentUpdateStep">Initializing...</span>
                    <span style="color: #666; font-family: var(--font-secondary); font-size: 0.9em;" id="contentUpdateProgress">0%</span>
                </div>

                <!-- Progress Bar -->
                <div style="width: 100%; height: 30px; background: #f0f0f0; border-radius: 15px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);">
                    <div id="contentUpdateProgressBar" style="height: 100%; width: 0%; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); transition: width 0.5s ease; display: flex; align-items: center; justify-content: center; color: #F2F0EF; font-weight: 600; font-size: 0.9em;"></div>
                </div>
            </div>

            <div style="padding: 15px; background: #f9f9f9; border-radius: 8px; margin-bottom: 20px;">
                <p id="contentUpdateMessage" style="margin: 0; color: #666; font-family: var(--font-secondary); font-size: 0.95em;">Starting content update process...</p>
            </div>

            <div style="padding: 15px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; margin-bottom: 20px;">
                <p style="margin: 0; color: #856404; font-family: var(--font-secondary); font-size: 0.9em;">
                    <strong>Warning:</strong> Do not close this window or navigate away during the update process.
                </p>
            </div>

            <button id="cancelContentUpdateBtn" onclick="cancelContentUpdate()" style="padding: 10px 20px; background: #6c757d; color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-family: var(--font-primary);">
                Cancel
            </button>
        </div>
    </div>

    <!-- Device Metadata Edit Modal -->
    <div id="deviceMetadataModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; justify-content: center; align-items: center; font-family: var(--font-primary);">
        <div style="background: white; border-radius: 12px; padding: 30px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; box-shadow: 0 8px 32px rgba(0,0,0,0.3);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #FA582D;">
                <h2 style="color: #FA582D; font-size: 1.5em; font-weight: 700; margin: 0;">Edit Device Metadata</h2>
                <button onclick="closeDeviceMetadataModal()" style="background: none; border: none; font-size: 1.5em; color: #666; cursor: pointer; padding: 0; width: 30px; height: 30px; line-height: 30px;" onmouseover="this.style.color='#FA582D'" onmouseout="this.style.color='#666'">&times;</button>
            </div>
            
            <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
                <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;"><strong>MAC Address:</strong> <span id="deviceMetadataMac" style="font-family: monospace; color: #333;"></span></div>
                <div style="font-size: 0.9em; color: #666;"><strong>IP Address:</strong> <span id="deviceMetadataIp" style="font-family: monospace; color: #333;"></span></div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-size: 0.95em;">Custom Name</label>
                <input type="text" id="deviceMetadataName" placeholder="Enter custom device name" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; box-sizing: border-box; transition: border-color 0.3s;" onfocus="this.style.borderColor='#FA582D'" onblur="this.style.borderColor='#ddd'">
                <div style="font-size: 0.8em; color: #666; margin-top: 5px;">Leave empty to use default hostname</div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-size: 0.95em;">Location</label>
                <div style="position: relative;">
                    <input type="text" id="deviceMetadataLocation" placeholder="Enter device location (e.g., Building A, Room 205, Home Office)" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; box-sizing: border-box; transition: border-color 0.3s;" onfocus="this.style.borderColor='#FA582D'" onblur="this.style.borderColor='#ddd'">
                    <div id="locationAutocompleteDropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 2px solid #FA582D; border-top: none; border-radius: 0 0 6px 6px; max-height: 200px; overflow-y: auto; z-index: 10001; box-shadow: 0 4px 8px rgba(0,0,0,0.1);"></div>
                </div>
                <div style="font-size: 0.8em; color: #666; margin-top: 5px;">Building, room, office, or physical location. Start typing to see existing locations you can reuse.</div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-size: 0.95em;">Comment</label>
                <textarea id="deviceMetadataComment" placeholder="Enter device comment or notes" rows="4" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; box-sizing: border-box; resize: vertical; transition: border-color 0.3s; font-family: var(--font-secondary);" onfocus="this.style.borderColor='#FA582D'" onblur="this.style.borderColor='#ddd'"></textarea>
            </div>

            <div style="margin-bottom: 25px; position: relative;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-size: 0.95em;">Tags</label>
                <div style="position: relative;">
                    <input type="text" id="deviceMetadataTags" placeholder="Enter tags separated by commas (e.g., mobile, employee, priority)" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; box-sizing: border-box; transition: border-color 0.3s;" onfocus="this.style.borderColor='#FA582D'" onblur="this.style.borderColor='#ddd'">
                    <div id="tagAutocompleteDropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 2px solid #FA582D; border-top: none; border-radius: 0 0 6px 6px; max-height: 200px; overflow-y: auto; z-index: 10001; box-shadow: 0 4px 8px rgba(0,0,0,0.1);"></div>
                </div>
                <div style="font-size: 0.8em; color: #666; margin-top: 5px;">Separate multiple tags with commas. Start typing to see existing tags you can reuse.</div>
            </div>

            <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 25px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                <button onclick="closeDeviceMetadataModal()" style="padding: 10px 24px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#e0e0e0'" onmouseout="this.style.background='#f0f0f0'">Cancel</button>
                <button onclick="saveDeviceMetadataFromModal()" style="padding: 10px 24px; background: linear-gradient(135deg, #FA582D 0%, #C64620 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">Save</button>
            </div>
        </div>
    </div>

    <!-- Modal JavaScript Handlers -->
    <script>
        function closeDeviceMetadataModal() {
            const modal = document.getElementById('deviceMetadataModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        async function saveDeviceMetadataFromModal() {
            const modal = document.getElementById('deviceMetadataModal');
            if (!modal) return;

            const mac = modal.dataset.currentMac;
            if (!mac) {
                alert('Device MAC address not found');
                return;
            }

            const name = document.getElementById('deviceMetadataName').value.trim();
            const location = document.getElementById('deviceMetadataLocation').value.trim();
            const comment = document.getElementById('deviceMetadataComment').value.trim();
            const tagsInput = document.getElementById('deviceMetadataTags').value.trim();
            
            // Parse tags from comma-separated string
            const tags = tagsInput ? tagsInput.split(',').map(t => t.trim()).filter(t => t.length > 0) : [];

            const success = await saveDeviceMetadata(mac, name, location, comment, tags);
            if (success) {
                closeDeviceMetadataModal();
            }
        }

        // Close modal when clicking outside
        document.getElementById('deviceMetadataModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeDeviceMetadataModal();
            }
        });
    </script>

    <!-- Alert Configuration Modal -->
    <div id="alertConfigModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #fff5f0 100%); border-radius: 12px; padding: 30px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <h2 id="alertConfigModalTitle" style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.5em;">Create Alert</h2>
                <span class="close" onclick="closeAlertConfigModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
            </div>

            <form id="alertConfigForm">
            <input type="hidden" id="alertConfigId">

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Device</label>
                <select id="alertConfigDeviceId" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; font-family: var(--font-secondary);">
                    <option value="">Select Device</option>
                </select>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Metric Type</label>
                <select id="alertConfigMetricType" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; font-family: var(--font-secondary);">
                    <option value="throughput_in">Inbound Throughput (Mbps)</option>
                    <option value="throughput_out">Outbound Throughput (Mbps)</option>
                    <option value="throughput_total">Total Throughput (Mbps)</option>
                    <option value="cpu">Data Plane CPU Usage (Percentage %)</option>
                    <option value="memory">System Memory Usage (Percentage %)</option>
                    <option value="sessions">Active Sessions (Count)</option>
                    <option value="threats_critical">Critical Threats (Count)</option>
                    <option value="interface_errors">Interface Errors (Count)</option>
                </select>
            </div>

            <div style="display: grid; grid-template-columns: 120px 1fr; gap: 10px; margin-bottom: 20px;">
                <div>
                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Operator</label>
                    <select id="alertConfigOperator" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; font-family: var(--font-secondary);">
                        <option value=">">&gt;</option>
                        <option value="<">&lt;</option>
                        <option value=">=">&gt;=</option>
                        <option value="<=">&lt;=</option>
                        <option value="==">==</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Threshold Value</label>
                    <input type="number" id="alertConfigThreshold" step="0.01" placeholder="Enter threshold value" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; font-family: var(--font-secondary);">
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Severity</label>
                <select id="alertConfigSeverity" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; font-family: var(--font-secondary);">
                    <option value="info">Info</option>
                    <option value="warning">Warning</option>
                    <option value="critical">Critical</option>
                </select>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Notification Channels</label>
                <select id="alertConfigChannels" multiple style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; height: 100px; font-family: var(--font-secondary);">
                    <option value="email">Email</option>
                    <option value="webhook">Webhook</option>
                    <option value="slack">Slack</option>
                </select>
                <div style="font-size: 0.85em; color: #666; margin-top: 5px; font-family: var(--font-secondary);">Hold Ctrl/Cmd to select multiple</div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: flex; align-items: center; cursor: pointer;">
                    <input type="checkbox" id="alertConfigEnabled" checked style="margin-right: 8px; width: 18px; height: 18px;">
                    <span style="color: #333; font-weight: 600; font-family: var(--font-primary);">Enabled</span>
                </label>
            </div>

            <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 25px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                <button type="button" onclick="closeAlertConfigModal()" style="padding: 10px 24px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Cancel</button>
                <button type="button" onclick="saveAlertConfig()" style="padding: 10px 24px; background: linear-gradient(135deg, #FA582D 0%, #C64620 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Save</button>
            </div>
            </form>
        </div>
    </div>

    <!-- Template Details Modal -->
    <div id="templateDetailsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #fff8f5 100%); border-radius: 12px; padding: 30px; max-width: 700px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <h2 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.5em;">Template Details</h2>
                <span class="close" onclick="closeTemplateDetailsModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
            </div>
            <div id="templateDetailsContent" style="font-family: var(--font-secondary);"></div>
            <div style="display: flex; justify-content: flex-end; margin-top: 20px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                <button onclick="closeTemplateDetailsModal()" style="padding: 10px 24px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Close</button>
            </div>
        </div>
    </div>

    <!-- Apply Template Modal -->
    <div id="applyTemplateModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #ffede0 100%); border-radius: 12px; padding: 30px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <h2 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.5em;">Apply Alert Template</h2>
                <span class="close" onclick="closeApplyTemplateModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
            </div>

            <input type="hidden" id="applyTemplateId">

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Select Device</label>
                <select id="applyTemplateDeviceId" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; font-family: var(--font-secondary);">
                    <option value="">Select Device</option>
                </select>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Notification Channels</label>
                <select id="applyTemplateChannels" multiple style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; height: 100px; font-family: var(--font-secondary);">
                    <option value="email">Email</option>
                    <option value="webhook">Webhook</option>
                    <option value="slack">Slack</option>
                </select>
                <div style="font-size: 0.85em; color: #666; margin-top: 5px; font-family: var(--font-secondary);">Hold Ctrl/Cmd to select multiple</div>
            </div>

            <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 25px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                <button onclick="closeApplyTemplateModal()" style="padding: 10px 24px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Cancel</button>
                <button onclick="applyTemplate()" style="padding: 10px 24px; background: linear-gradient(135deg, #FA582D 0%, #FF7A55 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Apply Template</button>
            </div>
        </div>
    </div>

    <!-- Apply Quick Start Modal -->
    <div id="applyQuickStartModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #ffe8d5 100%); border-radius: 12px; padding: 30px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <h2 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.5em;">Apply Quick Start Scenario</h2>
                <span class="close" onclick="closeApplyQuickStartModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
            </div>

            <input type="hidden" id="applyQuickStartId">

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-family: var(--font-primary);">Select Device</label>
                <select id="applyQuickStartDeviceId" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; font-family: var(--font-secondary);">
                    <option value="">Select Device</option>
                </select>
            </div>

            <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
                <p style="margin: 0; font-size: 0.9em; color: #666; font-family: var(--font-secondary);">This scenario will apply multiple pre-configured templates with recommended settings for your environment.</p>
            </div>

            <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 25px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                <button onclick="closeApplyQuickStartModal()" style="padding: 10px 24px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Cancel</button>
                <button onclick="applyQuickStart()" style="padding: 10px 24px; background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; cursor: pointer; font-family: var(--font-primary);">Apply Scenario</button>
            </div>
        </div>
    </div>

    <!-- Templates Browser Modal -->
    <div id="templatesBrowserModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #fff5ed 100%); border-radius: 12px; padding: 30px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <div>
                    <h2 style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary); font-size: 1.6em;">Browse Alert Templates</h2>
                    <p style="color: #666; margin: 0; font-family: var(--font-secondary); font-size: 0.95em;">Choose from professional monitoring templates for common scenarios</p>
                </div>
                <span class="close" onclick="closeTemplatesBrowserModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
            </div>

            <div id="templatesBrowserContainer"></div>
        </div>
    </div>

    <!-- Quick Start Browser Modal -->
    <div id="quickStartBrowserModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #fff0e5 100%); border-radius: 12px; padding: 30px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <div>
                    <h2 style="color: #333; margin: 0 0 5px 0; font-family: var(--font-primary); font-size: 1.6em;">Quick Start Scenarios</h2>
                    <p style="color: #666; margin: 0; font-family: var(--font-secondary); font-size: 0.95em;">Deploy complete monitoring setups optimized for common environments</p>
                </div>
                <span class="close" onclick="closeQuickStartBrowserModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
            </div>

            <div id="quickStartBrowserContainer"></div>
        </div>
    </div>

    <!-- Alert History Modal -->
    <div id="alertHistoryModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #fffaf5 100%); border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <h2 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.6em;">Alert History</h2>
                <span class="close" onclick="closeAlertHistoryModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: inline-flex; align-items: center; cursor: pointer;">
                    <input type="checkbox" id="historyUnresolvedOnly" onchange="filterAlertHistory()" style="margin-right: 8px;">
                    <span style="color: #333; font-weight: 500; font-family: var(--font-primary);">Show unresolved alerts only</span>
                </label>
            </div>

            <div id="alertHistoryTableModal" style="font-family: var(--font-secondary);"></div>
        </div>
    </div>

    <!-- Active Alerts Modal -->
    <div id="activeAlertsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #fff5f0 100%); border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <h2 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.6em;">Active Alerts</h2>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <button onclick="resolveAllActiveAlerts()" style="padding: 8px 16px; background: linear-gradient(135deg, #28a745 0%, #218838 100%); color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-family: var(--font-primary); font-weight: 600; font-size: 0.9em; transition: all 0.2s; box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(40, 167, 69, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(40, 167, 69, 0.3)'">Resolve All</button>
                    <span class="close" onclick="closeActiveAlertsModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
                </div>
            </div>
            <div id="activeAlertsTable" style="font-family: var(--font-secondary);"></div>
        </div>
    </div>

    <!-- INFO Alerts Modal -->
    <div id="infoAlertsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: white; border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(23, 162, 184, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #17a2b8; padding-bottom: 15px;">
                <h2 style="color: #17a2b8; margin: 0; font-family: var(--font-primary); font-size: 1.6em;">ℹ️ INFO Alerts</h2>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <button onclick="acknowledgeAllInfoAlerts()" style="padding: 8px 16px; background: #17a2b8; color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-family: var(--font-primary); font-weight: 600; font-size: 0.9em;">Acknowledge All</button>
                    <span class="close" onclick="closeInfoAlertsModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
                </div>
            </div>
            <div id="infoAlertsTable" style="font-family: var(--font-secondary);"></div>
        </div>
    </div>

    <!-- WARNING Alerts Modal -->
    <div id="warningAlertsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: white; border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(255, 193, 7, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #ffc107; padding-bottom: 15px;">
                <h2 style="color: #ffc107; margin: 0; font-family: var(--font-primary); font-size: 1.6em;">⚠️ WARNING Alerts</h2>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <button onclick="acknowledgeAllWarningAlerts()" style="padding: 8px 16px; background: #ffc107; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-family: var(--font-primary); font-weight: 600; font-size: 0.9em;">Acknowledge All</button>
                    <span class="close" onclick="closeWarningAlertsModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
                </div>
            </div>
            <div id="warningAlertsTable" style="font-family: var(--font-secondary);"></div>
        </div>
    </div>

    <!-- CRITICAL Alerts Modal -->
    <div id="criticalAlertsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: white; border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(220, 53, 69, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #dc3545; padding-bottom: 15px;">
                <h2 style="color: #dc3545; margin: 0; font-family: var(--font-primary); font-size: 1.6em;">🚨 CRITICAL Alerts</h2>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <button onclick="acknowledgeAllCriticalAlerts()" style="padding: 8px 16px; background: #dc3545; color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-family: var(--font-primary); font-weight: 600; font-size: 0.9em;">Acknowledge All</button>
                    <span class="close" onclick="closeCriticalAlertsModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
                </div>
            </div>
            <div id="criticalAlertsTable" style="font-family: var(--font-secondary);"></div>
        </div>
    </div>

    <!-- Alert History Modal (Last 50 Alerts - All Severities) -->
    <div id="alertHistoryFullModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: white; border-radius: 12px; padding: 30px; max-width: 1200px; width: 90%; max-height: 85vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #6c757d; padding-bottom: 15px;">
                <h2 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.6em;">📜 Alert History (Last 50)</h2>
                <span class="close" onclick="closeAlertHistoryFullModal()" style="font-size: 28px; color: #999; cursor: pointer; font-weight: 300; line-height: 1; transition: color 0.2s;">&times;</span>
            </div>
            <div id="alertHistoryFullTable" style="font-family: var(--font-secondary);"></div>
        </div>
    </div>

    <!-- Nmap Network Scan Modal (v1.10.14) -->
    <div id="nmapScanModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #e8f4ff 100%); border-radius: 12px; padding: 30px; max-width: 900px; width: 90%; max-height: 85vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(23, 162, 184, 0.3); border-top: 4px solid #F7D9BC;">
            <!-- Modal Header -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0; font-family: var(--font-primary); color: #17a2b8; font-size: 1.5em;">
                    Network Scan (Nmap)
                </h3>
                <button onclick="closeNmapScanModal()" style="background: none; border: none; font-size: 1.8em; color: #666; cursor: pointer; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; transition: color 0.2s;" onmouseover="this.style.color='#17a2b8'" onmouseout="this.style.color='#666'">×</button>
            </div>

            <!-- IP Address Display -->
            <div style="background: #f0f8ff; padding: 15px; border-radius: 6px; margin-bottom: 20px; border-left: 4px solid #17a2b8;">
                <div style="font-size: 0.9em; color: #666; margin-bottom: 4px; font-family: var(--font-secondary);">Target IP:</div>
                <div id="nmapScanIp" style="font-size: 1.2em; font-weight: 600; font-family: monospace; color: #17a2b8;"></div>
            </div>

            <!-- Scan Controls -->
            <div id="nmapScanControls" style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: 600; margin-bottom: 8px; font-size: 0.95em; font-family: var(--font-primary);">Scan Type:</label>
                <select id="nmapScanType" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer; font-family: var(--font-secondary); margin-bottom: 15px;">
                    <option value="quick">Quick Scan (Fast, top ports only)</option>
                    <option value="balanced" selected>Balanced Scan (Recommended - version detection + OS fingerprinting)</option>
                    <option value="thorough">Thorough Scan (Comprehensive, may take 60-90 seconds)</option>
                </select>

                <button onclick="startNmapScan()" style="width: 100%; padding: 14px 20px; background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: #F2F0EF; border: none; border-radius: 6px; font-size: 1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; font-family: var(--font-primary); box-shadow: 0 4px 10px rgba(23, 162, 184, 0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 15px rgba(23, 162, 184, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 10px rgba(23, 162, 184, 0.3)'">
                    Start Scan
                </button>
            </div>

            <!-- Scan Progress -->
            <div id="nmapScanProgress" style="display: none; text-align: center; padding: 40px 20px;">
                <div style="display: inline-block; width: 60px; height: 60px; border: 4px solid #f3f3f3; border-top: 4px solid #F7D9BC; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                <style>
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                </style>
                <div id="nmapScanProgressText" style="margin-top: 20px; font-size: 1em; color: #666; font-family: var(--font-secondary);">
                    Running scan (May take 30-60 seconds)...
                </div>
            </div>

            <!-- Scan Error -->
            <div id="nmapScanError" style="display: none; background: #fff0f0; border-left: 4px solid #dc3545; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
                <div style="font-weight: 600; color: #dc3545; margin-bottom: 8px; font-family: var(--font-primary); font-size: 1em;">Scan Failed</div>
                <div id="nmapScanErrorMessage" style="color: #666; font-family: var(--font-secondary); font-size: 0.9em;"></div>
            </div>

            <!-- Scan Results -->
            <div id="nmapScanResults" style="display: none;">
                <div style="border-top: 2px solid #e0e0e0; padding-top: 20px; margin-bottom: 20px;">
                    <h4 style="margin: 0 0 15px 0; font-family: var(--font-primary); color: #333; font-size: 1.2em;">Scan Results</h4>
                    <div id="nmapResultsContent"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Insights Modal (v1.13.0) -->
    <div id="enhancedInsightsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 16px; width: 90%; max-width: 1400px; max-height: 90vh; overflow: hidden; box-shadow: 0 8px 32px rgba(0,0,0,0.3); display: flex; flex-direction: column;">
            <!-- Modal Header -->
            <div style="background: linear-gradient(135deg, #FA582D 0%, #E04F26 100%); color: #F2F0EF; padding: 25px 30px; display: flex; justify-content: space-between; align-items: center; border-top-left-radius: 16px; border-top-right-radius: 16px;">
                <div>
                    <h2 style="margin: 0; font-size: 1.8em; font-family: var(--font-primary); font-weight: 700;">⚡ Enhanced Insights</h2>
                    <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9em; font-family: var(--font-secondary);">Advanced System Metrics & Performance Data</p>
                </div>
                <button onclick="closeEnhancedInsightsModal()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.5); color: #F2F0EF; font-size: 1.5em; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-family: var(--font-primary); display: flex; align-items: center; justify-content: center; transition: all 0.2s;">
                    ×
                </button>
            </div>

            <!-- Tab Navigation -->
            <div style="background: #f8f9fa; border-bottom: 2px solid #e9ecef; padding: 0 30px;">
                <div class="enhanced-insights-tabs" style="display: flex; gap: 5px;">
                    <button class="ei-tab active" data-tab="overview" onclick="switchEnhancedInsightsTab('overview')" style="padding: 15px 25px; background: none; border: none; border-bottom: 3px solid #FA582D; color: #FA582D; font-weight: 600; cursor: pointer; font-family: var(--font-primary); font-size: 1em; transition: all 0.3s;">
                        📊 Overview
                    </button>
                    <button class="ei-tab" data-tab="system-health" onclick="switchEnhancedInsightsTab('system-health')" style="padding: 15px 25px; background: none; border: none; border-bottom: 3px solid transparent; color: #666; font-weight: 600; cursor: pointer; font-family: var(--font-primary); font-size: 1em; transition: all 0.3s;">
                        💚 System Health
                    </button>
                    <button class="ei-tab" data-tab="network" onclick="switchEnhancedInsightsTab('network')" style="padding: 15px 25px; background: none; border: none; border-bottom: 3px solid transparent; color: #666; font-weight: 600; cursor: pointer; font-family: var(--font-primary); font-size: 1em; transition: all 0.3s;">
                        🌐 Network
                    </button>
                    <button class="ei-tab" data-tab="security" onclick="switchEnhancedInsightsTab('security')" style="padding: 15px 25px; background: none; border: none; border-bottom: 3px solid transparent; color: #666; font-weight: 600; cursor: pointer; font-family: var(--font-primary); font-size: 1em; transition: all 0.3s;">
                        🔒 Security
                    </button>
                    <button class="ei-tab" data-tab="databases" onclick="switchEnhancedInsightsTab('databases')" style="padding: 15px 25px; background: none; border: none; border-bottom: 3px solid transparent; color: #666; font-weight: 600; cursor: pointer; font-family: var(--font-primary); font-size: 1em; transition: all 0.3s;">
                        💾 Databases
                    </button>
                </div>
            </div>

            <!-- Tab Content Container -->
            <div style="flex: 1; overflow-y: auto; padding: 30px;">
                <!-- Overview Tab -->
                <div id="ei-tab-overview" class="ei-tab-content" style="display: block;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <!-- Disk Usage Card -->
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 25px; color: #F2F0EF; box-shadow: 0 4px 15px rgba(102,126,234,0.3);">
                            <h3 style="margin: 0 0 15px 0; font-size: 0.9em; opacity: 0.9; font-family: var(--font-primary);">💽 DISK USAGE</h3>
                            <div id="ei-disk-root" style="font-size: 2.5em; font-weight: 700; margin-bottom: 10px; font-family: var(--font-primary);">--</div>
                            <div style="font-size: 0.85em; opacity: 0.9; font-family: var(--font-secondary);">
                                <div>Logs: <span id="ei-disk-logs">--</span></div>
                                <div>Var: <span id="ei-disk-var">--</span></div>
                            </div>
                        </div>

                        <!-- Session Utilization Card -->
                        <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 12px; padding: 25px; color: #F2F0EF; box-shadow: 0 4px 15px rgba(245,87,108,0.3);">
                            <h3 style="margin: 0 0 15px 0; font-size: 0.9em; opacity: 0.9; font-family: var(--font-primary);">🔄 SESSION UTILIZATION</h3>
                            <div id="ei-session-util" style="font-size: 2.5em; font-weight: 700; margin-bottom: 10px; font-family: var(--font-primary);">--</div>
                            <div style="font-size: 0.85em; opacity: 0.9; font-family: var(--font-secondary);">
                                <div>Active: <span id="ei-session-active">--</span></div>
                                <div>Max Capacity: <span id="ei-session-max">--</span></div>
                            </div>
                        </div>

                        <!-- Database Versions Card -->
                        <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 12px; padding: 25px; color: #F2F0EF; box-shadow: 0 4px 15px rgba(79,172,254,0.3);">
                            <h3 style="margin: 0 0 15px 0; font-size: 0.9em; opacity: 0.9; font-family: var(--font-primary);">💾 THREAT DB</h3>
                            <div id="ei-threat-version" style="font-size: 1.5em; font-weight: 700; margin-bottom: 10px; font-family: var(--font-primary);">--</div>
                            <div style="font-size: 0.85em; opacity: 0.9; font-family: var(--font-secondary);">
                                <div>App: <span id="ei-app-version">--</span></div>
                                <div>WildFire: <span id="ei-wildfire-version">--</span></div>
                            </div>
                        </div>

                        <!-- System Status Card -->
                        <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 12px; padding: 25px; color: #F2F0EF; box-shadow: 0 4px 15px rgba(67,233,123,0.3);">
                            <h3 style="margin: 0 0 15px 0; font-size: 0.9em; opacity: 0.9; font-family: var(--font-primary);">✅ SYSTEM STATUS</h3>
                            <div id="ei-system-status" style="font-size: 1.8em; font-weight: 700; margin-bottom: 10px; font-family: var(--font-primary);">Healthy</div>
                            <div style="font-size: 0.85em; opacity: 0.9; font-family: var(--font-secondary);">
                                <div>Last Check: <span id="ei-last-check">--</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats Grid -->
                    <div style="background: #f8f9fa; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 20px 0; color: #333; font-family: var(--font-primary);">📈 Current Metrics</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: white; border-radius: 8px; padding: 15px; border-left: 4px solid #FA582D;">
                                <div style="color: #666; font-size: 0.85em; margin-bottom: 5px; font-family: var(--font-secondary);">CPU Data Plane</div>
                                <div id="ei-cpu-dp" style="font-size: 1.5em; font-weight: 700; color: #FA582D; font-family: var(--font-primary);">--</div>
                            </div>
                            <div style="background: white; border-radius: 8px; padding: 15px; border-left: 4px solid #E04F26;">
                                <div style="color: #666; font-size: 0.85em; margin-bottom: 5px; font-family: var(--font-secondary);">Memory Usage</div>
                                <div id="ei-memory" style="font-size: 1.5em; font-weight: 700; color: #E04F26; font-family: var(--font-primary);">--</div>
                            </div>
                            <div style="background: white; border-radius: 8px; padding: 15px; border-left: 4px solid #B8541E;">
                                <div style="color: #666; font-size: 0.85em; margin-bottom: 5px; font-family: var(--font-secondary);">Active Sessions</div>
                                <div id="ei-sessions" style="font-size: 1.5em; font-weight: 700; color: #B8541E; font-family: var(--font-primary);">--</div>
                            </div>
                            <div style="background: white; border-radius: 8px; padding: 15px; border-left: 4px solid #8C3D16;">
                                <div style="color: #666; font-size: 0.85em; margin-bottom: 5px; font-family: var(--font-secondary);">Throughput</div>
                                <div id="ei-throughput" style="font-size: 1.5em; font-weight: 700; color: #8C3D16; font-family: var(--font-primary);">--</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- System Health Tab -->
                <div id="ei-tab-system-health" class="ei-tab-content" style="display: none;">
                    <h3 style="margin: 0 0 20px 0; color: #333; font-family: var(--font-primary);">💚 System Health Monitoring</h3>

                    <!-- Disk Usage Charts -->
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #666; font-family: var(--font-primary);">💽 Disk Usage Over Time</h4>
                        <canvas id="ei-disk-chart" style="max-height: 300px;"></canvas>
                    </div>

                    <!-- Session Utilization Chart -->
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h4 style="margin: 0 0 15px 0; color: #666; font-family: var(--font-primary);">🔄 Session Utilization Trend</h4>
                        <canvas id="ei-session-chart" style="max-height: 300px;"></canvas>
                    </div>
                </div>

                <!-- Network Tab -->
                <div id="ei-tab-network" class="ei-tab-content" style="display: none;">
                    <h3 style="margin: 0 0 20px 0; color: #333; font-family: var(--font-primary);">🌐 Network Performance</h3>
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <p style="color: #666; font-family: var(--font-secondary);">Network performance metrics from resource monitor data will be displayed here.</p>
                        <div id="ei-network-content"></div>
                    </div>
                </div>

                <!-- Security Tab -->
                <div id="ei-tab-security" class="ei-tab-content" style="display: none;">
                    <h3 style="margin: 0 0 20px 0; color: #333; font-family: var(--font-primary);">🔒 Security Metrics</h3>
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <p style="color: #666; font-family: var(--font-secondary);">Security metrics and threat detection data will be displayed here.</p>
                        <div id="ei-security-content"></div>
                    </div>
                </div>

                <!-- Databases Tab -->
                <div id="ei-tab-databases" class="ei-tab-content" style="display: none;">
                    <h3 style="margin: 0 0 20px 0; color: #333; font-family: var(--font-primary);">💾 Database Versions</h3>
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div style="border-left: 4px solid #4facfe; padding-left: 15px;">
                                <h4 style="margin: 0 0 10px 0; color: #666; font-family: var(--font-primary);">Application Database</h4>
                                <div id="ei-db-app-version" style="font-size: 1.3em; font-weight: 700; color: #4facfe; font-family: var(--font-primary); margin-bottom: 5px;">--</div>
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-secondary);">App identification & categorization</div>
                            </div>
                            <div style="border-left: 4px solid #f093fb; padding-left: 15px;">
                                <h4 style="margin: 0 0 10px 0; color: #666; font-family: var(--font-primary);">Threat Database</h4>
                                <div id="ei-db-threat-version" style="font-size: 1.3em; font-weight: 700; color: #f093fb; font-family: var(--font-primary); margin-bottom: 5px;">--</div>
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-secondary);">Antivirus & vulnerability signatures</div>
                            </div>
                            <div style="border-left: 4px solid #FA582D; padding-left: 15px;">
                                <h4 style="margin: 0 0 10px 0; color: #666; font-family: var(--font-primary);">WildFire Database</h4>
                                <div id="ei-db-wildfire-version" style="font-size: 1.3em; font-weight: 700; color: #FA582D; font-family: var(--font-primary); margin-bottom: 5px;">--</div>
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-secondary);">Cloud-based malware analysis</div>
                            </div>
                            <div style="border-left: 4px solid #43e97b; padding-left: 15px;">
                                <h4 style="margin: 0 0 10px 0; color: #666; font-family: var(--font-primary);">URL Filtering Database</h4>
                                <div id="ei-db-url-version" style="font-size: 1.3em; font-weight: 700; color: #43e97b; font-family: var(--font-primary); margin-bottom: 5px;">--</div>
                                <div style="color: #999; font-size: 0.85em; font-family: var(--font-secondary);">Web categorization & filtering</div>
                            </div>
                        </div>

                        <div style="margin-top: 25px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <p style="margin: 0; color: #666; font-size: 0.9em; font-family: var(--font-secondary);">
                                <strong>Last Updated:</strong> <span id="ei-db-last-updated">--</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load JavaScript modules in order -->
    <!-- Load data services FIRST - provides enterprise-grade data layer (v2.1.0) -->
    <script defer src="/static/services/throughput-data-service.js?v=1732067200"></script>
    <!-- Load app.js SECOND - provides window.apiClient and init() for other modules -->
    <!-- defer ensures scripts execute in order AFTER DOM is ready and prevents race conditions -->
    <script defer src="/static/app.js?v=1732408800"></script>
    <script defer src="/static/logs.js"></script>
    <script defer src="/static/pages.js?v=1.10.10"></script>

    <!-- Connected Devices modules (Phase 6 refactoring - v1.8.2) - Load in order: core, metadata, export -->
    <script defer src="/static/pages-connected-devices-core.js"></script>
    <script defer src="/static/pages-connected-devices-metadata.js"></script>
    <script defer src="/static/pages-connected-devices-export.js"></script>
    <script defer src="/static/pages-connected-devices-sankey.js"></script>

    <!-- Page-specific modules (depend on app.js) -->
    <script defer src="/static/devices.js?v=1.8.4"></script>
    <script defer src="/static/settings.js?v=1.9.0"></script>
    <script defer src="/static/pages-nmap-scan.js"></script>
    <!-- Chord Tag Filter Modal -->
    <div id="chordTagFilterModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #fff5f0 100%); border-radius: 12px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px rgba(250, 88, 45, 0.3); border-top: 4px solid #F7D9BC;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
                <h2 style="color: #333; margin: 0; font-family: var(--font-primary); font-size: 1.5em;">Filter by Device Tags</h2>
                <button onclick="closeChordTagFilterModal()" style="background: none; border: none; font-size: 1.5em; color: #999; cursor: pointer; line-height: 1; padding: 0; transition: color 0.2s;" onmouseover="this.style.color='#FA582D'" onmouseout="this.style.color='#999'">×</button>
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 10px; color: #333; font-weight: 600; font-family: var(--font-primary);">Select Tags:</label>
                <select id="chordTagFilterModalSelect" multiple size="8" style="width: 100%; padding: 10px; border: 2px solid #FA582D; border-radius: 6px; font-family: var(--font-secondary); background: white; color: #333;">
                    <!-- Tags will be populated by JavaScript -->
                </select>
                <p style="color: #666; font-size: 0.85em; margin-top: 8px; font-family: var(--font-secondary);">Hold Ctrl/Cmd to select multiple tags</p>
            </div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button onclick="clearChordTagFilter()" style="padding: 10px 20px; background: #6c757d; color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-family: var(--font-primary); transition: background 0.2s;" onmouseover="this.style.background='#5a6268'" onmouseout="this.style.background='#6c757d'">Clear</button>
                <button onclick="applyChordTagFilter()" style="padding: 10px 20px; background: #FA582D; color: #F2F0EF; border: none; border-radius: 6px; cursor: pointer; font-family: var(--font-primary); transition: background 0.2s;" onmouseover="this.style.background='#E04F26'" onmouseout="this.style.background='#FA582D'">Apply</button>
            </div>
        </div>
    </div>

    <script defer src="/static/pages-applications.js"></script>
    <script defer src="/static/pages-panos-upgrade.js"></script>
    <script defer src="/static/pages-content-updates.js"></script>
    <script defer src="/static/pages-backup-restore.js"></script>
    <script defer src="/static/pages-alerts.js?v=1.10.2"></script>
    <script defer src="/static/pages-analytics.js"></script>
    <script defer src="/static/pages-enhanced-insights.js"></script>
</body>
</html>
